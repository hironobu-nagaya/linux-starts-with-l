<!DOCTYPE html>
<html lang="ja"><head><title>Lから始まるLinux - 3章28話 execコマンド</title><base href="../.."><meta charset="utf-8"><meta name="author" content="Hironobu Nagaya"><meta name="robots" content="all"><meta name="keywords" content="Lから始まるLinux,Linux starts with L,linux,shell script,exec"><meta name="description" content="兄妹の対話を通してLinuxへの理解を深めていくお話です"><meta name="viewport" content="width=device-width, initial-scale=0.5" /><meta name="format-detection" content="telephone=no, email=no, address=no" /><link rel="prev" href="3/27/" /><link rel="next" href="3/29/" /><link rel="icon" href="favicon.svg" type="image/svg+xml"><link rel="stylesheet" href="css/normalize.css" type="text/css"><link rel="stylesheet" href="css/common.css" type="text/css"><link rel="stylesheet" href="css/story.css" type="text/css"></head><body><header><h1>Lから始まるLinux</h1><div class="relation"><div><div>前</div><div>3章27話</div><div><a href="3/27/">ジョブ管理</a></div></div><div><div>今</div><div>3章28話 execコマンド</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>3章29話</div><div><a href="3/29/">ANSIエスケープシーケンス</a></div></div></div></header><main><section><article class="header1"><code>exec</code><span> コマンド</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>今回はシェルのプロセスを</span></span><span><span>置き換える方法を学ぼう！</span></span></div></article><article class="talk"><div><img src="img/midori-surprised.svg" alt="若木 みどり(驚き)" /></div><div><span><span>え？</span></span><span><span>意味がよくわからないんですけど？！</span></span></div></article><article class="header2"><span>仕組み</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>プロセスを置き換える</span></span><span><span>理由を理解するために</span></span><span><span>まずはプロセスの</span></span><span><span>親子関係の話から入ろう</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>プロセスは親子関係があって</span></span><span><span>親プロセスから子プロセスが</span></span><span><span>作られるんだよね？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そうそう</span></span><span><span>その話だよ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>今動いているシェルを</span></span><span><code>pstree</code><span> の表示のように</span></span><span><span>表現してみよう</span></span></div></article><article class="code"><pre><code class="console">bash
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>このシェル </span><code>bash</code><span> が</span></span><span><span>私の入力を処理してくれるんだよね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そういうことになるね</span></span><span><span>このシェルからシェルスクリプトを</span></span><span><span>実行したとしよう</span></span><span><span>親子関係はこのようになるんだ</span></span></div></article><article class="code"><pre><code class="console">bash <wbr>─── <wbr>bash
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>うん</span></span><span><span>これは理解できるよ！</span></span><span><span>親の </span><code>bash</code><span> が</span></span><span><span>私の入力を受け付けるシェルで</span></span><span><span>子の </span><code>bash</code><span> が</span></span><span><span>シェルスクリプトを解釈するシェル</span></span><span><span>というわけだね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>ここで実行している</span></span><span><span>シェルスクリプトが</span></span><span><span>以下のようなものだったとしよう</span></span></div></article><article class="code"><pre><code class="bash">#!/bin/bash
ls <wbr>-l <wbr>&quot;$@&quot;
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><code>ls</code><span> に </span><code>-l</code><span> オプションを</span></span><span><span>付けてくれるスクリプトだね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>このシェルスクリプトで</span></span><span><code>ls</code><span> が実行されると</span></span><span><span>このようになるのはわかるかな</span></span></div></article><article class="code"><pre><code class="console">bash <wbr>─── <wbr>bash <wbr>─── <wbr>ls
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>そうなるよね</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>でもこうやって見てみると</span></span><span><span>シェルスクリプトの</span></span><span><span>シェル </span><code>bash</code><span> が余計に感じるなぁ</span></span><span><span>だって </span><code>ls</code><span> を呼び出しているだけでしょ？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>このように一つのコマンドを</span></span><span><span>便利にしたりするスクリプトを</span></span><span><span><wbr>「ラッパースクリプト(wrapper script)」<wbr></span></span><span><span>とよぶよ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>メインとなるコマンドを</span></span><span><span><wbr>「つつんで(wrap)」<wbr></span></span><span><span>便利にしてあげているんだね</span></span></div></article><article class="header2"><span>使い方</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>このようなラッパースクリプトで</span></span><span><span>使われるのが </span><code>exec</code><span> なんだ</span></span></div></article><article class="code"><pre><code class="bash">exec <wbr>[オプション]... <wbr>[コマンド]
</code></pre></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>これは </span><code>exec</code><span> を動かした</span></span><span><span>シェルのプロセスを</span></span><span><code>コマンド</code><span> のプロセスに</span></span><span><span>置き換えてくれるよ</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>さっきのスクリプトの例だと</span></span><span><span>こんな感じになるよ</span></span></div></article><article class="code"><pre><code class="bash">#!/bin/bash
exec <wbr>ls <wbr>-l <wbr>&quot;$@&quot;
</code></pre></article><article class="talk"><div><img src="img/midori-surprised.svg" alt="若木 みどり(驚き)" /></div><div><span><span>じゃあこのスクリプトを実行すると</span></span><span><span>親子関係はこうなっちゃうんだ？！</span></span></div></article><article class="code"><pre><code class="console">bash <wbr>─── <wbr>ls
</code></pre></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そのとおり！</span></span><span><span>シェルスクリプトを動かしていた</span></span><span><code>bash</code><span> のプロセスが</span></span><span><code>ls</code><span> のプロセスに置き換わるんだ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><code>bash</code><span> プロセスが</span></span><span><code>ls</code><span> に置き換わっちゃうんでしょ？</span></span><span><code>exec</code><span> より後に</span></span><span><span>記述があったらどうなっちゃうの？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>ls</code><span> のプロセスが</span></span><span><span>処理を終えた時点で終了になるよ</span></span><span><span>だから </span><code>exec</code><span> 以降に記述があったとしても</span></span><span><span>それらの記述は実行されないことになるんだ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>つまり </span><code>exec</code><span> は</span></span><span><span>ラッパースクリプトの最後で使うんだね！</span></span></div></article><article class="header2"><span>まとめ</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>今回はシェルのプロセスを置き換える</span></span><span><code>exec</code><span> を学んだよ！</span></span><span><span>ラッパースクリプトの場合に使われるよ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>exec</code><span> とリダイレクトを組み合わせ</span></span><span><span>3番以降のファイルディスクリプタを</span></span><span><span>使う目的でも利用されるんだ</span></span><span><span>これは高度な使い方なので</span></span><span><span>ここでは説明はしないけど</span></span><span><span>興味があれば</span></span><span><span><wbr>「exec リダイレクト」<wbr></span></span><span><span>などで検索してみよう！</span></span></div></article></section></main><footer><div class="relation"><div><div>前</div><div>3章27話</div><div><a href="3/27/">ジョブ管理</a></div></div><div><div>今</div><div>3章28話 execコマンド</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>3章29話</div><div><a href="3/29/">ANSIエスケープシーケンス</a></div></div></div></footer><script src="js/jquery.js"></script><script src="js/common.js"></script></body></html>