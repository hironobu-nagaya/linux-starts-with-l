<!DOCTYPE html>
<html lang="ja"><head><title>Lから始まるLinux - 4章11話 特殊なパーミッション操作</title><base href="../.."><meta charset="utf-8"><meta name="author" content="Hironobu Nagaya"><meta name="robots" content="all"><meta name="keywords" content="Lから始まるLinux,Linux starts with L,linux,super user,root,sticky bit,SETGID,SETUID,chmod"><meta name="description" content="兄妹の対話を通してLinuxへの理解を深めていくお話です"><meta name="viewport" content="width=device-width, initial-scale=0.5" /><meta name="format-detection" content="telephone=no, email=no, address=no" /><link rel="prev" href="4/10/" /><link rel="next" href="4/12/" /><link rel="icon" href="favicon.svg" type="image/svg+xml"><link rel="stylesheet" href="css/normalize.css" type="text/css"><link rel="stylesheet" href="css/common.css" type="text/css"><link rel="stylesheet" href="css/story.css" type="text/css"></head><body><header><h1>Lから始まるLinux</h1><div class="relation"><div><div>前</div><div>4章10話</div><div><a href="4/10/">特殊なパーミッション</a></div></div><div><div>今</div><div>4章11話 特殊なパーミッション操作</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>4章12話</div><div><a href="4/12/">nologin</a></div></div></div></header><main><section><article class="header1"><span>特殊なパーミッション操作</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>前回は特殊なパーミッション</span></span><span><span>sticky bit, <wbr>SETGID, <wbr>SETUID</span></span><span><span>を学んだね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>今回はそれらを</span></span><span><span>管理する方法を教えるよ！</span></span><span><span>パーミッションには変わりないので</span></span><span><code>chmod</code><span> で変更するんだ</span></span></div></article><article class="header2"><span>シンボリック形式による指定</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>シンボリック形式は</span></span><span><span><wbr>「対象」<wbr><wbr>「どうするか」<wbr><wbr>「権限」<wbr> の</span></span><span><span>3種類の文字の組み合わせで</span></span><span><span>権限を指定するんだよね</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そのうち<wbr>「権限」<wbr>の部分で</span></span><span><span>特殊なパーミッションを指定するんだ</span></span><span><span>以下のような感じだよ</span></span></div></article><article class="table"><table><thead><tr><th><span>権限</span></th><th><span>意味</span></th></tr></thead><tbody><tr><td><code>s</code></td><td><span>SETGID, <wbr>SETUID</span></td></tr><tr><td><code>t</code></td><td><span>sticky bit</span></td></tr></tbody></table></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>あれ？</span></span><span><span>SETGID と SETUID が</span></span><span><span>同じ文字を使っているね？</span></span><span><span>SETGID と SETUID の区別が</span></span><span><span>できないよ？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>これは<wbr>「対象」<wbr>と組み合わせて区別するんだ</span></span><span><span><wbr>「所有グループ」<wbr>と組み合わせれば SETGID</span></span><span><span><wbr>「所有ユーザ」<wbr>と組み合わせれば SETUID となるよ</span></span></div></article><article class="table"><table><thead><tr><th><span>指定</span></th><th><span>意味</span></th></tr></thead><tbody><tr><td><code>u+s</code></td><td><span>SETUID を与える</span></td></tr><tr><td><code>g-s</code></td><td><span>SETGID を除く</span></td></tr></tbody></table></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>なるほど！</span></span><span><span><wbr>「対象」<wbr>で区別するんだね！</span></span></div></article><article class="header2"><span>オクタル形式による指定</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>通常は3桁の八進数で表現するけど</span></span><span><span>特殊なパーミッションは</span></span><span><span><wbr>「4桁目」<wbr>で表現するんだ</span></span></div></article><article class="table"><table><thead><tr><th><span>4桁目の数値</span></th><th><span>意味</span></th></tr></thead><tbody><tr><td><code>4</code></td><td><span>SUID</span></td></tr><tr><td><code>2</code></td><td><span>SGID</span></td></tr><tr><td><code>1</code></td><td><span>sticky bit</span></td></tr></tbody></table></article><article class="talk"><div><img src="img/midori-surprised.svg" alt="若木 みどり(驚き)" /></div><div><span><span>3桁が当たり前だと思っていたけど</span></span><span><span>4桁目がかくされていたんだ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>いくつか例を挙げよう</span></span></div></article><article class="table"><table><thead><tr><th><span>指定</span></th><th><span>意味</span></th></tr></thead><tbody><tr><td><code>1777</code></td><td><span>sticky bit を設定し、<wbr>全員に読み書き実行権限を設定</span></td></tr><tr><td><code>4755</code></td><td><span>SETUID を設定し、<wbr>所有ユーザに読み書き実行権限、<wbr>所有グループやその他には読み込み権限と実行権限を設定</span></td></tr></tbody></table></article><article class="header2"><span>SETUID の注意</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>特殊なパーミッションは</span></span><span><span>特殊な用途で使われるんだ</span></span><span><span>本当に必要な場合しか</span></span><span><span>使ってはいけないよ！</span></span></div></article><article class="talk"><div><img src="img/midori-surprised.svg" alt="若木 みどり(驚き)" /></div><div><span><span>そ、<wbr>そんなに</span></span><span><span>注意しないといけないの？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>特に SETUID はそうだよ</span></span><span><span>実行ファイルの所有ユーザが </span><code>root</code><span> で</span></span><span><span>SETUID が設定されていたら</span></span><span><span>誰が実行しても </span><code>root</code><span> 権限で</span></span><span><span>実行されるんだ！</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>うわぁ…</span></span><span><span>言葉だけでも重大さが伝わるよ…</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>システムに侵入された際の典型的な操作に</span></span><span><span><wbr>「</span><code>bash</code><span> をコピーして SETUID を設定する」<wbr></span></span><span><span>があるんだ</span></span><span><span>この </span><code>bash</code><span> から実行されるコマンドは</span></span><span><span>全て </span><code>root</code><span> ユーザの権限で動くよ</span></span><span><span>侵入者はこの </span><code>bash</code><span> を使って</span></span><span><span>システムを自由に操作するんだ</span></span></div></article><article class="header2"><span>まとめ</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>今回は特殊なパーミッションの設定方法を学んだよ！</span></span><span><span>あまり使うことがないと良いなぁと思っているよ…</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>実際使う機会は少ないから安心してね</span></span><span><span>でもいざという時に対応ができないから</span></span><span><span>知っておくことは大事だよ！</span></span></div></article></section></main><footer><div class="relation"><div><div>前</div><div>4章10話</div><div><a href="4/10/">特殊なパーミッション</a></div></div><div><div>今</div><div>4章11話 特殊なパーミッション操作</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>4章12話</div><div><a href="4/12/">nologin</a></div></div></div></footer><script src="js/jquery.js"></script><script src="js/common.js"></script></body></html>