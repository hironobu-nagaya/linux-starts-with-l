<!DOCTYPE html>
<html lang="ja"><head><title>Lから始まるLinux - 6章6話 ポート</title><base href="../.."><meta charset="utf-8"><meta name="author" content="Hironobu Nagaya"><meta name="robots" content="all"><meta name="keywords" content="Lから始まるLinux,Linux starts with L,linux,port,lsof,ss"><meta name="description" content="兄妹の対話を通してLinuxへの理解を深めていくお話です"><meta name="viewport" content="width=device-width, initial-scale=0.5" /><meta name="format-detection" content="telephone=no, email=no, address=no" /><link rel="prev" href="6/5/" /><link rel="next" href="6/7/" /><link rel="icon" href="favicon.svg" type="image/svg+xml"><link rel="stylesheet" href="css/normalize.css" type="text/css"><link rel="stylesheet" href="css/common.css" type="text/css"><link rel="stylesheet" href="css/story.css" type="text/css"></head><body><header><h1>Lから始まるLinux</h1><div class="relation"><div><div>前</div><div>6章5話</div><div><a href="6/5/">ストレージ</a></div></div><div><div>今</div><div>6章6話 ポート</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>6章7話</div><div><a href="6/7/">デーモン</a></div></div></div></header><main><section><article class="header1"><span>ポート</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>これまでで代表的なリソース</span></span><span><span><wbr>「CPU」<wbr><wbr>「メモリ」<wbr><wbr>「ストレージ」<wbr>の</span></span><span><span>確認方法を覚えたよ！</span></span><span><span>他にもサーバ管理者が</span></span><span><span>確認できるといいものって何かな？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>ネットワーク周りの確認も重要だね</span></span><span><span>今回はポートの確認方法を学んでいこう！</span></span></div></article><article class="header2"><code>lsof</code><span> コマンド</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>lsof</code><span> は</span></span><span><span>プロセスが開いている</span></span><span><span>ファイルを表示するよ</span></span><span><span>list open file の略なんだ</span></span></div></article><article class="code"><pre><code class="bash">lsof <wbr>[オプション]... <wbr>[名前]...
</code></pre></article><article class="table"><table><thead><tr><th><span>オプション</span></th><th><span>説明</span></th></tr></thead><tbody><tr><td><code>-i</code></td><td><span>ポートを表示</span></td></tr><tr><td><code>-P</code></td><td><span>ポート番号をサービス名に変換しない</span></td></tr></tbody></table></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>開いているファイルを</span></span><span><span>確認するコマンドで</span></span><span><span>ポートを確認するんだ？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>Linux の考え方に</span></span><span><span><wbr>「全てをファイルとして扱う」<wbr>があるよ</span></span><span><span>なのでポート確認も</span></span><span><code>lsof</code><span> で確認できるんだ</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>早速ポートを</span></span><span><span>確認してみよう！</span></span></div></article><article class="code"><pre><code class="bash">sudo <wbr>lsof <wbr>-i <wbr>-P
</code></pre></article><article class="code"><pre><code class="console">COMMAND     <wbr>PID     <wbr>USER   <wbr>FD   <wbr>TYPE <wbr>DEVICE <wbr>SIZE/OFF <wbr>NODE <wbr>NAME
...
sshd        <wbr>962     <wbr>root   <wbr>3u   <wbr>IPv4  <wbr>30008      <wbr>0t0  <wbr>TCP <wbr>*:22 <wbr>(LISTEN)
...
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>見やすく一覧表示してくれるんだね！</span></span><span><code>sshd</code><span> が 22 番ポートで</span></span><span><span>待ち受けしてるのがわかるよ！</span></span></div></article><article class="header2"><code>ss</code><span> コマンド</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>ss</code><span> は</span></span><span><span>ソケット接続の</span></span><span><span>統計情報を表示するよ</span></span><span><span>socket statistics の略なんだ</span></span></div></article><article class="code"><pre><code class="bash">ss <wbr>[オプション]... <wbr>[フィルタ]
</code></pre></article><article class="table"><table><thead><tr><th><span>オプション</span></th><th><span>説明</span></th></tr></thead><tbody><tr><td><code>-t</code><span>, <wbr></span><code>--tcp</code></td><td><span>TCP ソケットを表示</span></td></tr><tr><td><code>-u</code><span>, <wbr></span><code>--udp</code></td><td><span>UDP ソケットを表示</span></td></tr><tr><td><code>-a</code><span>, <wbr></span><code>--all</code></td><td><span>Listen 状況にかかわらず全てのソケットを表示</span></td></tr><tr><td><code>-p</code><span>, <wbr></span><code>--processes</code></td><td><span>ソケットを利用しているプロセスを表示</span></td></tr><tr><td><code>-n</code><span>, <wbr></span><code>--numeric</code></td><td><span>ポート番号をサービス名に変換しない</span></td></tr></tbody></table></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>ポート確認ができるけど</span></span><span><span>本来の用途が違うのね</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>以下のようにすると</span></span><span><code>lsof</code><span> と同様の情報が見られるよ</span></span></div></article><article class="code"><pre><code class="bash">sudo <wbr>ss <wbr>-tuapn
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>オプションの指定が多いけど</span></span><span><span>細かく制御できるということなんだね</span></span></div></article><article class="code"><pre><code class="console">State    <wbr>Recv-Q   <wbr>Send-Q     <wbr>Local <wbr>Address:Port       <wbr>Peer <wbr>Address:Port    <wbr>Process
...
LISTEN   <wbr>0        <wbr>128        <wbr>*:22                     <wbr>*:*                  <wbr>users:((&quot;sshd&quot;,pid=962,fd=3))
...
</code></pre></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>ss</code><span> ほとんどのシステムで使える</span></span><span><span>標準的なコマンドなんだ</span></span><span><span>どの環境でも使えると</span></span><span><span>考えていいのも強みだよ</span></span></div></article><article class="header2"><span>まとめ</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>今回はポート確認の方法を学んだよ！</span></span><span><code>lsof</code><span> や </span><code>ss</code><span> で確認できるんだ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>ポートの状態を知ることで指定したポートで</span></span><span><span>アプリケーションが待ち受けているかとか</span></span><span><span>管理外のプログラムが勝手に</span></span><span><span>ポートを利用していないかなどを確認できるんだ</span></span><span><span>ほとんどのサーバプログラムは</span></span><span><span>ネットワークを使うので</span></span><span><span>ポート確認は大事な基礎知識だよ！</span></span></div></article></section></main><footer><div class="relation"><div><div>前</div><div>6章5話</div><div><a href="6/5/">ストレージ</a></div></div><div><div>今</div><div>6章6話 ポート</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>6章7話</div><div><a href="6/7/">デーモン</a></div></div></div></footer><script src="js/jquery.js"></script><script src="js/common.js"></script></body></html>