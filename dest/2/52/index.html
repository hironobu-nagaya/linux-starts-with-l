<!DOCTYPE html>
<html lang="ja"><head><title>Lから始まるLinux - 2章52話 sedコマンド</title><base href="../.."><meta charset="utf-8"><meta name="author" content="Hironobu Nagaya"><meta name="robots" content="all"><meta name="keywords" content="Lから始まるLinux,Linux starts with L,linux,sed"><meta name="description" content="兄妹の対話を通してLinuxへの理解を深めていくお話です"><meta name="viewport" content="width=device-width, initial-scale=0.5" /><meta name="format-detection" content="telephone=no, email=no, address=no" /><link rel="prev" href="2/51/" /><link rel="next" href="2/53/" /><link rel="icon" href="favicon.svg" type="image/svg+xml"><link rel="stylesheet" href="css/normalize.css" type="text/css"><link rel="stylesheet" href="css/common.css" type="text/css"><link rel="stylesheet" href="css/story.css" type="text/css"></head><body><header><h1>Lから始まるLinux</h1><div class="relation"><div><div>前</div><div>2章51話</div><div><a href="2/51/">grepコマンド</a></div></div><div><div>今</div><div>2章52話 sedコマンド</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>2章53話</div><div><a href="2/53/">awkコマンド</a></div></div></div></header><main><section><article class="header1"><code>sed</code><span> コマンド</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>お兄ちゃんから</span></span><span><span>正規表現を使ったコマンドを</span></span><span><span>教えてもらっているんだよ！</span></span><span><span>前回は </span><code>grep</code><span> だったね</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>今回は </span><code>sed</code><span> を扱ってみよう！</span></span></div></article><article class="header2"><span>使い方</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>sed</code><span> は</span></span><span><span><wbr>「ストリームエディタ(stream editor)」<wbr>の略で</span></span><span><span>入力を一括で編集するためのコマンドなんだ</span></span><span><span>編集後の内容は標準出力へ出力されるよ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>エディタなんだ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そう！</span></span><span><span>エディタなので</span></span><span><span>色々な編集ができるんだ</span></span><span><span>全部の機能は覚えられないので</span></span><span><span>今回はよく使われる</span></span><span><span><wbr>「置換コマンド </span><code>s</code><span> (substitute) 」<wbr></span></span><span><span>を覚えよう！</span></span><span><span>以下のように使用するよ</span></span></div></article><article class="code"><pre><code class="bash">sed <wbr>[オプション]... <wbr>'s/置換前/置換後/フラグ' <wbr>ファイル
</code></pre></article><article class="table"><table><thead><tr><th><span>オプション</span></th><th><span>役割</span></th></tr></thead><tbody><tr><td><span>-i [extension]</span></td><td><span>編集結果を標準出力ではなく編集対象ファイルに書き出す。<wbr>extention を指定すると </span><code>ファイル名extension</code><span> というファイル名で編集前のバックアップを作成する</span></td></tr></tbody></table></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>ファイルの各行で</span></span><span><span>最初に見つかった </span><code>置換前</code><span> を</span></span><span><code>置換後</code><span> に置き換えた内容を出力するんだ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><code>置換前</code><span> の指定に</span></span><span><span>正規表現が使えるんだね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span><wbr>「フラグ」<wbr>は </span><code>g</code><span> だけ覚えよう</span></span><span><span>最初に見つかったものだけなく</span></span><span><span>全ての </span><code>置換前</code><span> を </span><code>置換後</code><span> に変更するよ</span></span></div></article><article class="header2"><span>実践</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>では実際の例を見てみよう</span></span><span><code>sed</code><span> で前回扱った</span></span><span><code>/etc/passwd</code><span> を加工してみよう</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>情報が </span><code>:</code><span> 区切りになっていて</span></span><span><span>最初がユーザ名だったよね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そのことを知っていれば</span></span><span><span>以下のようにすることで</span></span><span><span>全ユーザを列挙できるんだ</span></span></div></article><article class="code"><pre><code class="bash">sed <wbr>'s/:.*//' <wbr>/etc/passwd
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>どんな結果になるのかな？</span></span></div></article><article class="code"><pre><code class="console">root
bin
...
shigeru
midori
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>区切り文字 </span><code>:</code><span> と</span></span><span><span>その後に続く任意の文字列 </span><code>.*</code><span> を</span></span><span><span>空っぽに置き換える…</span></span><span><span>つまり削除するんだね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そういうことだね</span></span><span><span>これでユーザ名一覧を</span></span><span><span>取り出しているんだ</span></span></div></article><article class="header2"><span>区切り文字を変える</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span><wbr>「置換前」<wbr>や<wbr>「置換後」<wbr>の指定に</span></span><span><span><wbr>「スラッシュ(</span><code>/</code><span>)」<wbr>が</span></span><span><span>含まれていたらどうするの？</span></span><span><span>例えばパスとかは</span></span><span><span>たくさん含まれるんだけど…</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>実は </span><code>s</code><span> の直後に来る文字が</span></span><span><span>置換操作の区切り文字になるんだ</span></span><span><span>なので以下のように</span></span><span><span>別の区切り文字を使えるよ</span></span></div></article><article class="code"><pre><code class="bash">sed <wbr>\
    <wbr>'s%/home/shigeru%/home/midori%g' <wbr>\
    <wbr>&lt;&lt;&lt; <wbr>&quot;/home/shigeru/diary&quot;
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>なるほど！</span></span><span><span>この例では </span><code>%</code><span> を</span></span><span><span>区切りに使っているんだね！</span></span><span><span>普段は<wbr>「スラッシュ(</span><code>/</code><span>)」<wbr>だけど</span></span><span><span>不都合なときは別の文字を使っても良いんだ！</span></span></div></article><article class="header2"><span>まとめ</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>今回は </span><code>sed</code><span> のうち置換の方法を学んだよ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>sed</code><span> では置換以外にも</span></span><span><span>多くの編集操作が用意されているよ</span></span><span><span>大抵のテキスト処理は </span><code>sed</code><span> だけでできてしまう</span></span><span><span>万能コマンドなんだ</span></span></div></article></section></main><footer><div class="relation"><div><div>前</div><div>2章51話</div><div><a href="2/51/">grepコマンド</a></div></div><div><div>今</div><div>2章52話 sedコマンド</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>2章53話</div><div><a href="2/53/">awkコマンド</a></div></div></div></footer><script src="js/jquery.js"></script><script src="js/common.js"></script></body></html>