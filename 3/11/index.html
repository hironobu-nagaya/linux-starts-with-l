<html lang="ja">
<head>
<title>Lから始まるLinux - 3章11話 while文(実践)</title>
<base href="../..">
<meta charset="utf-8">
<meta name="author" content="Hironobu Nagaya">
<meta name="robots" content="all">
<meta name="keywords" content="Lから始まるLinux,Linux starts with L,linux,shell script,while,read">
<meta name="description" content="兄妹の対話を通してLinuxへの理解を深めていくお話です">
<meta name="viewport" content="width=device-width, initial-scale=0.5" />
<meta name="format-detection" content="telephone=no, email=no, address=no" />
<link rel="prev" href="3/10/" />
<link rel="next" href="3/12/" />
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link rel="stylesheet" href="css/normalize.css" type="text/css">
<link rel="stylesheet" href="css/common.css" type="text/css">
<link rel="stylesheet" href="css/story.css" type="text/css">
</head>
<body>
<header>
<h1>Lから始まるLinux</h1>
<div class="relation">
<div>
<div>前</div>
<div>3章10話</div>
<div><a href="3/10/">while文(使い方)</a></div>
</div>
<div>
<div>今</div>
<div>3章11話 while文(実践)</div>
<div><a href=".">もくじ</a></div>
</div>
<div>
<div>次</div>
<div>3章12話</div>
<div><a href="3/12/">制御文とリダイレクト</a></div>
</div>
</div>
</header>
<main>
<section>
<article class="header1"><code>while</code><span>文(実践)</span></article>
<article class="talk">
<div><img src="img/midori.svg" alt="若木 みどり" /></div>
<div>
<span><span>前回は</span><code>while</code><span>文と</span></span>
<span><span>繰り返しを制御する</span></span>
<span><code>continue</code><span> と </span><code>break</code><span> を</span></span>
<span><span>教えてもらったね！</span></span>
</div>
</article>
<article class="talk">
<div><img src="img/shigeru.svg" alt="若木 しげる" /></div>
<div>
<span><span>今回は</span><code>while</code><span>文を使った</span></span>
<span><span>シェルスクリプトを</span></span>
<span><span>書いてみよう！</span></span>
</div>
</article>
<article class="header2"><span>実践</span></article>
<article class="talk">
<div><img src="img/shigeru.svg" alt="若木 しげる" /></div>
<div>
<span><span>今回は空行を削除する</span></span>
<span><code>remove-empty-lines</code><span> スクリプトを</span></span>
<span><span>作成しよう！</span></span>
<span><span>まずはエディタを開いてね</span></span>
</div>
</article>
<article class="code"><pre><code class="bash">vim <wbr>remove-empty-lines
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>うん!</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>次に以下の内容を</span></span><span><span>入力して保存しよう</span></span></div></article><article class="code"><pre><code class="bash">#!/bin/bash

while <wbr>read <wbr>LINE
do
  <wbr>grep <wbr>-sq <wbr>'^ <wbr>*$' <wbr>&lt;&lt;&lt; <wbr>&quot;$LINE&quot; <wbr>&amp;&amp; <wbr>continue
  <wbr>echo <wbr>&quot;$LINE&quot;
done
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>内容が少なくて</span></span><span><span>シンプルだね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>記述は少ないけど</span></span><span><span>学ぶものは多いものに</span></span><span><span>仕上がっているんだ！</span></span></div></article><hr /><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><code>while</code><span>のコマンドの所で</span></span><span><code>read</code><span> を使っているね</span></span><span><span>コマンドが成功する限り</span></span><span><span>繰り返すんだけど</span></span><span><code>read</code><span> の成功って</span></span><span><span>何なんだろう？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>入力があれば成功</span></span><span><span>なければ失敗になるよ</span></span><span><span>これは後で実行して確認するね</span></span></div></article><hr /><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>while</code><span>文の処理を見てみよう</span></span><span><span>以下の1行は何をしているかな</span></span></div></article><article class="code"><pre><code class="bash">grep <wbr>-sq <wbr>'^ <wbr>*$' <wbr>&lt;&lt;&lt; <wbr>&quot;$LINE&quot; <wbr>&amp;&amp; <wbr>continue
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>AND 演算子 </span><code>&amp;&amp;</code><span> を使って</span></span><span><span>前半のコマンドが成功したら</span></span><span><code>continue</code><span> をしているね</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>肝心の前半だけど…</span></span><span><code>LINE</code><span> 変数の内容を</span></span><span><code>grep</code><span> で検索しているね</span></span><span><span>検索内容は正規表現 </span><code>^ *$</code><span> で</span></span><span><span>これは<wbr>「スペースが任意の数ある行」<wbr></span></span><span><span>つまり<wbr>「空行」<wbr>となるよ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>つまり </span><code>LINE</code><span> 変数の値が空行なら</span></span><span><span>この繰り返しを終えて</span></span><span><span>次の繰り返しに移る</span></span><span><span>ということだね！</span></span></div></article><hr /><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>処理の2行目は単純だけど</span></span><span><span>1行目と組み合わせると</span></span><span><span>どんな動きになるのかな？</span></span></div></article><article class="code"><pre><code class="bash">echo <wbr>&quot;$LINE&quot;
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>1行目で<wbr>「空行」<wbr>なら</span></span><span><code>continue</code><span> しているので</span></span><span><span><wbr>「内容のある行」<wbr>だけ</span></span><span><span>表示という意味になるね！</span></span><span><span>最初のスクリプトの説明のとおり</span></span><span><span>空行を削除したものが表示されるんだ！</span></span></div></article><article class="header2"><span>実行</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>今回は</span><code>while</code><span>文と</span></span><span><code>read</code><span> を組み合わせた</span></span><span><span>動きを知るために</span></span><span><span>実行権限を与えて</span></span><span><span>動かしてみよう！</span></span></div></article><article class="code"><pre><code class="bash">chmod <wbr>a+x <wbr>remove-empty-lines
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>うん！</span></span><span><span>準備 OK だよ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>では実行してみよう！</span></span></div></article><article class="code"><pre><code class="bash">./remove-empty-lines
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>親切な入力メッセージは</span></span><span><span>付けていないから</span></span><span><span>何も表示されていないけど</span></span><span><span>入力を受け付ける状態に</span></span><span><span>なっているんだね</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そのとおり！</span></span><span><span>空ではない文字列を入れて</span></span><span><span>Enter を押してみよう！</span></span></div></article><article class="code"><pre><code class="bash">バウムクーヘン<span class="cursor">▌</span>
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>これで Enter を押すね</span></span></div></article><article class="code"><pre><code class="bash">バウムクーヘン
バウムクーヘン
<span class="cursor">▌</span>
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>空行じゃなかったので</span></span><span><code>echo</code><span> で内容を表示して</span></span><span><span>次の繰り返しの</span></span><span><code>read</code><span> が実行されたね！</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>この処理を終えるのには</span></span><span><span>どうすればいいのかな？</span></span><span><span>文字を入れず Enter かな？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>それだと<wbr>「空文字」<wbr>を</span></span><span><span>入力したことになるんだ</span></span><span><span>何も文字を入れていない状態で</span></span><span><span>Ctrl + D を押してみよう！</span></span><span><span>これは<wbr>「入力の終わり」<wbr>を</span></span><span><span>伝える操作だよ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><code>remove-empty-lines</code><span> スクリプトが終わって</span></span><span><span>プロンプトが表示されたよ！</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>でも…</span></span><span><span>このスクリプトは役に立つのかな？</span></span><span><span>手入力した内容の空行を削除されても…</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そのまま実行しても面白みがいよね</span></span><span><span>このスクリプトは入力リダイレクトや</span></span><span><span>パイプなどと組み合わせて使うんだ</span></span><span><span>以下のようにしてみよう！</span></span></div></article><article class="code"><pre><code class="bash">./remove-empty-lines <wbr>&lt;&lt; <wbr>EOF

フィナンシェ


シュークリーム

マドレーヌ
EOF
</code></pre></article><article class="talk"><div><img src="img/midori-surprised.svg" alt="若木 みどり(驚き)" /></div><div><span><span>あっ！</span></span><span><span>もしかして…</span></span></div></article><article class="code"><pre><code class="console">フィナンシェ
シュークリーム
マドレーヌ
</code></pre></article><article class="talk"><div><img src="img/midori-surprised.svg" alt="若木 みどり(驚き)" /></div><div><span><span>おお！</span></span><span><span>手入力以外の入力も</span></span><span><code>read</code><span> で処理できるんだ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>これは入力の1行ずつが</span></span><span><code>read</code><span> コマンドで処理され</span></span><span><span>入力の終わりに達すると</span></span><span><code>read</code><span> が失敗を返して</span></span><span><code>while</code><span>文が終了するんだ</span></span></div></article><article class="talk"><div><img src="img/midori-smile.svg" alt="若木 みどり(笑顔)" /></div><div><span><span>つまり…</span></span><span><span>入力の各行を順に</span></span><span><span>処理できるんだね！</span></span><span><span>これはすごい！</span></span></div></article><article class="header2"><span>まとめ</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>今回は</span><code>while</code><span>文で</span></span><span><span>シェルスクリプトを書いたよ！</span></span><span><code>while</code><span>文と </span><code>read</code><span> を組み合わせることで</span></span><span><span>入力の各行を繰り返し処理できるんだ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>これは入力の各行を処理する</span></span><span><span>定番の書き方なんだ</span></span><span><span>使う機会もあるので</span></span><span><span>覚えておこう！</span></span></div></article><article class="code"><pre><code class="bash">while <wbr>read <wbr>LINE
do
  <wbr>LINE変数を使った処理
done
</code></pre></article></section></main><footer><div class="relation"><div><div>前</div><div>3章10話</div><div><a href="3/10/">while文(使い方)</a></div></div><div><div>今</div><div>3章11話 while文(実践)</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>3章12話</div><div><a href="3/12/">制御文とリダイレクト</a></div></div></div></footer><script src="js/jquery.js"></script><script src="js/common.js"></script></body></html>
