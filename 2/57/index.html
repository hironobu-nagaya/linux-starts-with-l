<html lang="ja">
<head>
<title>Lから始まるLinux - 2章57話 awkコマンド</title>
<base href="../..">
<meta charset="utf-8">
<meta name="author" content="Hironobu Nagaya">
<meta name="robots" content="all">
<meta name="keywords" content="Lから始まるLinux,Linux starts with L,linux,awk">
<meta name="description" content="兄妹の対話を通してLinuxへの理解を深めていくお話です">
<meta name="viewport" content="width=device-width, initial-scale=0.5" />
<meta name="format-detection" content="telephone=no, email=no, address=no" />
<link rel="prev" href="2/56/" />
<link rel="next" href="2/58/" />
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link rel="stylesheet" href="css/normalize.css" type="text/css">
<link rel="stylesheet" href="css/common.css" type="text/css">
<link rel="stylesheet" href="css/story.css" type="text/css">
</head>
<body>
<header>
<h1>Lから始まるLinux</h1>
<div class="relation">
<div>
<div>前</div>
<div>2章56話</div>
<div><a href="2/56/">sedコマンド</a></div>
</div>
<div>
<div>今</div>
<div>2章57話 awkコマンド</div>
<div><a href=".">もくじ</a></div>
</div>
<div>
<div>次</div>
<div>2章58話</div>
<div><a href="2/58/">テキスト関連コマンド(その1)</a></div>
</div>
</div>
</header>
<main>
<section>
<article class="header1"><code>awk</code><span> コマンド</span></article>
<article class="talk">
<div><img src="img/midori.svg" alt="若木 みどり" /></div>
<div>
<span><span>今、<wbr>お兄ちゃんから</span></span>
<span><span>正規表現を使った</span></span>
<span><span>コマンドを学んでいるよ！</span></span>
<span><span>これまでで </span><code>grep</code><span> と</span></span>
<span><code>sed</code><span> を学んだんだ！</span></span>
</div>
</article>
<article class="talk">
<div><img src="img/shigeru.svg" alt="若木 しげる" /></div>
<div>
<span><span>今回は </span><code>awk</code><span> を</span></span>
<span><span>学んでいこう！</span></span>
</div>
</article>
<article class="header2"><span>使い方</span></article>
<article class="talk">
<div><img src="img/shigeru.svg" alt="若木 しげる" /></div>
<div>
<span><code>awk</code><span> は</span></span>
<span><span>決まった構造を持った内容を</span></span>
<span><span>処理するのが得意なコマンドだよ</span></span>
<span><code>awk</code><span> は制作者3名の頭文字で</span></span>
<span><span>特定の意味を持った</span></span>
<span><span>単語ではないんだ</span></span>
</div>
</article>
<article class="code"><pre><code class="bash">awk <wbr>[オプション]... <wbr>'パターン <wbr>{アクション}' <wbr>[ファイル]
</code></pre></article><article class="table"><table><thead><tr><th><span>オプション</span></th><th><span>役割</span></th></tr></thead><tbody><tr><td><code>-F 文字列</code></td><td><span>指定された文字列をフィールド区切り文字にする</span></td></tr></tbody></table></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>構造を持った内容…</span></span><span><span>例えば今まで扱ったような</span></span><span><code>/etc/passwd</code><span> のようなものかな？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そうだね</span></span><span><span>後で </span><code>/etc/passwd</code><span> を</span></span><span><span>扱ってみよう！</span></span></div></article><article class="header2"><span>レコードとフィールド</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>読み込む内容の単位を</span></span><span><span><wbr>「レコード(record)」<wbr>と呼ぶんだ</span></span><span><span>デフォルトでは1行が<wbr>「レコード」<wbr>となるよ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>基本的には1行ずつ読み込んで</span></span><span><span>その内容を解析していくんだね</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>レコードは</span></span><span><span><wbr>「フィールドセパレータ(field separator, <wbr>FS)」<wbr></span></span><span><span>という区切り文字で区切られていて</span></span><span><span>その区切られた要素を</span></span><span><span><wbr>「フィールド」<wbr>と呼ぶよ</span></span><span><span>デフォルトではスペースやタブなど空白文字が</span></span><span><span>フィールドセパレータになっているんだ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span><wbr>「レコード」<wbr>が<wbr>「フィールド」<wbr>と呼ばれる要素で</span></span><span><span>構成されていると解釈してくれるんだ</span></span></div></article><article class="header2"><span>パターンとアクション</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>awk</code><span> の操作は<wbr>「パターン(pattern)」<wbr>と</span></span><span><span><wbr>「アクション(action)」<wbr>で指定するよ</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span><wbr>「パターン」<wbr>は処理対象のレコードの指定で</span></span><span><span>指定が無ければ全ての行で処理をしてくれるんだ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>指定すれば一部のレコードだけに</span></span><span><span>処理を絞れるんだね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span><wbr>「アクション」<wbr>は</span></span><span><span>処理内容で指定がなければ</span></span><span><span>レコードを表示してくれるんだ</span></span></div></article><article class="header2"><span>実例</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>定義ばかりで難しかったね</span></span><span><span>ここからは実例を見ながら</span></span><span><code>awk</code><span> を見ていこう</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>/etc/passwd</code><span> から</span></span><span><code>midori</code><span> ユーザの行を</span></span><span><span>抜き出してみよう！</span></span></div></article><article class="code"><pre><code class="bash">awk <wbr>'/^midori:/' <wbr>/etc/passwd
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><code>/^midori:/</code><span> は </span><code>{ ... <wbr>}</code><span> で</span></span><span><span>囲われていないから</span></span><span><span>パターンになるのかな？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そのとおり！</span></span><span><code>/ <wbr>... <wbr>/</code><span> は正規表現の指定なんだ</span></span><span><code>/^midori:/</code><span> で</span></span><span><span><wbr>「</span><code>midori:</code><span> で始まるレコードだけを処理」<wbr></span></span><span><span>という意味になるよ</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>アクションを指定していない場合は</span></span><span><span>レコードをそのまま表示するので</span></span><span><code>grep</code><span> と同じような動きになるよ</span></span></div></article><article class="code"><pre><code class="console">midori:x:1001:1001:Midori <wbr>Wakagi:/home/midori:/bin/bash
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>でも </span><code>/etc/passwd</code><span> の</span></span><span><span>区切り文字って </span><code>:</code><span> だよね？</span></span><span><span>そのことをちゃんと利用して</span></span><span><span>操作するにはどうすればいいのかな？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>それは </span><code>-F</code><span> オプションで</span></span><span><span>区切り文字を指定するよ</span></span><span><code>-F</code><span> オプションで</span></span><span><span>1文字を指定すると<wbr>「その文字」<wbr></span></span><span><span>2文字以上を指定すると正規表現になるんだ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>区切りを正規表現で指定できる？</span></span><span><span>それは柔軟にテキストを扱えそうだね</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>-F</code><span> オプションを使って</span></span><span><span>同じ動作をする </span><code>awk</code><span> コマンドを</span></span><span><span>書いてみよう！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>$0</code><span> がレコード全体</span></span><span><code>$1</code><span> が1番目のフィールド</span></span><span><code>$2</code><span> が2番目のフィールド</span></span><span><span>…を意味するんだ</span></span></div></article><article class="code"><pre><code class="bash">awk <wbr>-F: <wbr>'$1 <wbr>== <wbr>&quot;midori&quot;' <wbr>/etc/passwd
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>区切り文字を<wbr>「コロン(</span><code>:</code><span>)」<wbr>にして</span></span><span><span>1番目のフィールドが</span></span><span><code>midori</code><span> であるレコードを表示…</span></span><span><span>実行して結果を確認してみるね！</span></span></div></article><article class="code"><pre><code class="console">midori:x:1001:1001:Midori <wbr>Wakagi:/home/midori:/bin/bash
</code></pre></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>今度は<wbr>「アクション」<wbr>を</span></span><span><span>書いてみよう</span></span><span><code>print</code><span> は引数の内容を</span></span><span><span>表示してくれるんだ</span></span></div></article><article class="code"><pre><code class="bash">awk <wbr>-F: <wbr>'{ <wbr>print <wbr>$1 <wbr>}' <wbr>/etc/passwd
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>今度は<wbr>「パターン」<wbr>が</span></span><span><span>書かれていないね</span></span><span><span>ということは全部の行が</span></span><span><span>処理されるのかな</span></span></div></article><article class="code"><pre><code class="console">root
bin
...
shigeru
midori
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>あっ </span><code>sed</code><span> のときの例と</span></span><span><span>同じになったね！</span></span><span><span>全ての行から1番目のフィールドだけ</span></span><span><span>抜き出して表示してくれたんだね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>もちろん<wbr>「パターン」<wbr>と</span></span><span><span><wbr>「アクション」<wbr>を</span></span><span><span>混ぜて使うこともできるよ</span></span></div></article><article class="code"><pre><code class="bash">awk <wbr>-F: <wbr>'$1 <wbr>== <wbr>&quot;midori&quot; <wbr>{print <wbr>$1}' <wbr>/etc/passwd
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>区切り文字を<wbr>「コロン(</span><code>:</code><span>)」<wbr>にして</span></span><span><span>1番目のフィールドが </span><code>midori</code><span> である</span></span><span><span>レコードの1番目のフィールドを表示…</span></span><span><span>って意味ね！</span></span></div></article><article class="code"><pre><code class="console">midori
</code></pre></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>$1</code><span> はユーザ名なので</span></span><span><span>抜き出してもあまり面白くないけど</span></span><span><code>$1</code><span> の数字を別の数字に置き換えるなどの</span></span><span><span>応用ができるよ</span></span></div></article><article class="header2"><span>まとめ</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>今回は決まった構造を持った内容を</span></span><span><span>処理するのが得意な </span><code>awk</code><span> を学んだよ！</span></span><span><span>でも使いこなすのは大変そう…</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>実は </span><code>awk</code><span> はスクリプト言語でもあるんだ</span></span><span><span>なのでプログラミングもできるんだよ</span></span><span><code>grep</code><span> や </span><code>sed</code><span> の動きを再現できたように</span></span><span><span>たいていの処理は実現できるよ</span></span></div></article></section></main><footer><div class="relation"><div><div>前</div><div>2章56話</div><div><a href="2/56/">sedコマンド</a></div></div><div><div>今</div><div>2章57話 awkコマンド</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>2章58話</div><div><a href="2/58/">テキスト関連コマンド(その1)</a></div></div></div></footer><script src="js/jquery.js"></script><script src="js/common.js"></script></body></html>
