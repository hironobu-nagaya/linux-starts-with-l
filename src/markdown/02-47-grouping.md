chapter=2
story=47
title=グルーピング
keyword=grouping
prev=2/46/
prev-title=プロセス置換
next=2/48/
next-title=同一ファイルへの入出力

# グルーピング

しげる（通常）：
  今回はコマンドを束ねる
  「グルーピング(grouping)」を学ぼう！
みどり（通常）：
  コマンドを束ねる？
  どうやって使うのかな？

## `{ ... }` によるグルーピング

しげる（通常）：
  最初は `{ ... }` での
  グルーピングだよ
  書き方はこうだよ

```bash
{
  コマンド1
  コマンド2
  ...
}
```

みどり（通常）：
  ただまとめるだけ？
  動きには何か
  変化があるのかな？
しげる（通常）：
  まとめるだけだと
  何も変わらないけど
  他の機能と組み合わせて
  力を発揮するんだ
  例えばバックグラウンド実行と
  組み合わせてみよう

```bash
{
  echo "ファイルをダウンロード中…"
  sleep 10
  echo "完了！"
} &
```

しげる（通常）：
  ダウンロードは
  `sleep` で代用しているよ
しげる（通常）：
  このように複数のコマンドを
  1つのまとまりとして
  バックグラウンド実行できるんだ！
みどり（驚き）：
  便利だね！
  1行で書ききれなかったら
  グルーピングを使うよ！
しげる（通常）：
  もう一つよく使われるのはリダイレクトだよ
  グループ全体の出力をまとめて
  リダイレクトできるんだ
  例えば以下は警告メッセージを
  標準エラー出力として表示するよ

```bash
{
  echo "============"
  echo "！！警告！！"
  echo "============"
} >&2
```

みどり（笑顔）：
  全体を一括して
  リダイレクトできるんだね！

## `( ... )` によるグルーピング

しげる（通常）：
  似たようなものに
  `( ... )` があるんだ
  書き方は以下のとおりだよ

```bash
(
  コマンド1
  コマンド2
  ...
)
```

みどり（通常）：
  これもグルーピングなんだね
  `{ ... }` とどう違うのかな？
しげる（通常）：
  `( ... )` の中は
  元のシェルではなく
  「サブシェル(sub shell)」という
  別のシェル環境で実行されるんだ
みどり（通常）：
  サブシェル？
  わざわざ別のシェルで実行する
  理由がよくわからないな…
しげる（通常）：
  サブシェルで行った操作は
  元のシェルに影響を与えないんだ
  そのことを利用してこんなことができるよ

```bash
(
  cd /tmp
  echo "$(pwd) ディレクトリで操作をするよ！"
)
echo "操作が終わった後、現在のディレクトリは $(pwd)"
```

しげる（通常）：
  これはサブシェルで `/tmp` へ移動して
  そこでコマンドを実行しているけど
  元のシェルはディレクトリ移動の
  影響を受けていないんだ

```console
/tmp ディレクトリで操作をするよ！
操作が終わった後、現在のディレクトリは /home/midori
```
みどり（驚き）：
  へぇー…
  確かに現在のシェルの
  ディレクトリを変えずに
  別ディレクトリで作業を
  できるのは便利かも！

## まとめ

みどり（通常）：
  今回はグルーピングを学んだよ！
  `{ ... }` と `( ... )` は
  用途が違うんだね！
しげる（通常）：
  そのとおりだね！
  それぞれの特徴を意識して
  使い分けることが大事だよ

