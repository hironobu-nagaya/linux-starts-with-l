chapter=6
story=7
title=デーモン
keyword=daemon
keyword=systemd
keyword=systemctl
prev=6/6/
prev-title=ポート
next=6/8/
next-title=ログ

# デーモン

みどり（通常）：
  お兄ちゃん！
  サーバプログラムを
  扱えるようになるには
  他にどんな知識が必要かな？
しげる（通常）：
  それならサーバプログラムの基礎
  「デーモン」について学ぼう！

## 用語

しげる（通常）：
  Linux ではサーバプログラムを
  「デーモン(daemon)」と呼ぶんだ
  雑用をこなしてくれる
  精霊のような存在で
  「悪魔(demon)」とは違うよ
みどり（笑顔）：
  日本語で「デーモン」と書くと
  区別が付かないけど
  可愛い精霊さんなんだね！
しげる（通常）：
  多くのデーモンは
  その機能を表す名前の末尾に
  `d` を付けた名前にしているよ
  例えば以下のような
  デーモンがあるんだ

デーモン名 | 役割
---------- | ----
`sshd`     | SSH デーモン
`httpd`    | HTTP デーモン
`ftpd`     | FTP デーモン

みどり（通常）：
  `d` で終わっている
  コマンドやプロセスは
  デーモンの可能性が高いんだね

## デーモンの管理

しげる（通常）：
  最近の Linux では
  デーモンの管理を
  `systemd` が行なっているよ
みどり（驚き）：
  あっ！
  `systemd` は `d` で終わっているね！
  「システムを管理する」デーモンなんだ！
しげる（通常）：
  よく気が付いたね！
  `systemd` はシステム全体のプロセスを
  統括してくれているデーモンなんだ
しげる（通常）：
  まずは `systemd` が
  使われているか確認しよう
  使われている場合は
  一番親のプロセスが
  `systemd` になっているんだ
しげる（通常）：
  `pstree` で
  確認してみよう！

```bash
pstree
```

みどり（通常）：
  うん！
  `pstree` で
  親子関係を見るんだね！

```console
systemd─┬─ModemManager───2*[{ModemManager}]
        ├─NetworkManager───2*[{NetworkManager}]
        └─...
```

みどり（通常）：
  一番親のプロセスが
  `systemd` になっているよ！
しげる（通常）：
  このような場合 `systemd` が
  デーモンを管理しているよ
  `systemd` ではデーモンを
  「サービス(service)」と
  呼んでいるんだ
しげる（通常）：
  `systemd` は
  `systemctl` 経由で操作するんだ
  以下が代表的なコマンドだよ

コマンド                             | 意味
------------------------------------ | -----------------
`sudo systemctl start サービス`      | サービスを開始する
`sudo systemctl stop サービス`       | サービスを停止する
`sudo systemctl restart サービス`    | サービスを再起動する
`sudo systemctl reload サービス`     | サービスに設定を再読み込みさせる（非対応の場合がある）
`sudo systemctl is-active サービス`  | サービスの起動状態を確認する
`sudo systemctl enable サービス`     | ブート時のサービス自動起動を有効化する
`sudo systemctl disable サービス`    | ブート時のサービス自動起動を無効化する
`sudo systemctl is-enabled サービス` | ブート時のサービス自動起動の有効・無効を確認する
`sudo systemctl status サービス`     | サービスの状態を確認する

しげる（通常）：
  「自動起動を有効」と「起動」は
  同時に指定されることが多いんだ
  その操作は以下のコマンドでできるよ！

```bash
sudo systemctl enable --now サービス
```

みどり（通常）：
  デーモンのコマンドによって
  呼び出し方や引数が違うけど
  `systemctl` で統一された操作を
  実現しているんだね！

## まとめ

みどり（通常）：
  今回は「デーモン」について学んだよ！
  `systemd` がデーモンを管理して
  `systemctl` から操作を行うんだ！
しげる（通常）：
  これでサーバの基本的な操作が
  できるようになるよ！

