chapter=3
story=12
title=制御文とリダイレクト
keyword=shell script
keyword=control statement
keyword=redirect
prev=3/11/
prev-title=while文(実践)
next=3/13/
next-title=exitコマンド

# 制御文とリダイレクト

しげる（通常）：
  制御文
  `if`, `case`,
  `for`, `while` は
  リダイレクトと
  組み合わせるられるんだ！
みどり（驚き）：
  えっ？
  そうなの？！
しげる（通常）：
  今回は制御文と
  リダイレクトを
  組み合わせると
  どうなるかを
  見ていこう！

## 制御文と入力リダイレクト

しげる（通常）：
  最初は
  「入力リダイレクト `<`」だよ
  以下の例を見てみよう

```bash
while read LINE
do
  ...
done < ファイル
```

みどり（通常）：
  1行ずつ読む内容を
  `ファイル` から
  読み込むんだね！
しげる（通常）：
  そのとおり！
  制御文末尾の記述へ
  入力リダイレクト
  してあげればいいんだ
みどり（通常）：
  `for`文の場合は
  `done` に対して
  入力リダイレクトを
  書けばいいんだね！
しげる（通常）：
  入力は
  「ヒアドキュメント `<<`」や
  「ヒアストリング `<<<`」でも
  可能だよ

## 制御文と出力リダイレクト

しげる（通常）：
  今度は「出力リダイレクト `>`」だよ

```bash
while read LINE
do
  ...
done > ファイル
```

みどり（通常）：
  「入力リダイレクト」と
  同じように使えるんだね！
しげる（通常）：
  以下は`if`文の処理の
  「標準出力」を
  「標準エラー」へ
  書き出してくれるんだ

```bash
if コマンド
then
  ...
fi >&2
```

しげる（通常）：
  追記 `>>` でも
  同じように使えるよ！

## 制御文とパイプ

みどり（通常）：
  リダイレクトが
  使えるということは
  もしかしてパイプも
  使えたりする？
しげる（通常）：
  うん、使えるよ！
  パイプの前でも後ろでも
  両方の書き方ができるんだ
しげる（通常）：
  以下は `while`文で
  全てのユーザ名を処理するよ

```bash
awk -F: '{ print $1 }' /etc/passwd |
while read USERNAME
do
  ...
done
```

みどり（通常）：
  あれ？
  1行目の最後パイプの後に
  次の行もコマンドラインが
  続いていることを示す
  「バックスラッシュ(`\`)」は
  いらないのかな？
しげる（通常）：
  この場合は不要なんだ
  パイプのように
  「次の記述があるはず」
  とわかる記述では
  続く記述がなければ
  コマンドラインが
  次の行に続いていると
  自動的に判断されるよ
しげる（通常）：
  他にも
  AND 演算子 `&&` や
  OR 演算子 `||` でも
  同じような動きになるよ
みどり（驚き）：
  へぇ…
  こういう場合は
  「バックスラッシュ(`\`)」
  を省略できるんだね

## 制御文どうしを組み合わせる

しげる（通常）：
  発展的な話をしよう！
  なんと制御文どうしを
  パイプで繋げられるんだ！

```bash
if ...
then
  ...
else
  ...
fi |
while read LINE
do
  ...
done
```

みどり（驚き）：
  `while` 文で
  1行ずつ読む内容を
  `if` 文の条件で
  変えているんだね
みどり（通常）：
  すごい柔軟に
  できそうだけど
  色々な要素が
  からんで難しいよ…
しげる（通常）：
  発展的な使い方だからね
  使うのは実力が付いてからでも
  十分だよ！

## まとめ

みどり（通常）：
  今回は「制御文」と
  「リダイレクト」を
  組み合わせられることを
  学んだよ！
みどり（笑顔）：
  グルーピング `{ ... }` に
  近いイメージで使えるんだね！
しげる（通常）：
  これまで学んだ制御文を
  さらに色々なことに
  使える記述だよ
  難しいので急いで覚える必要はないけど
  知っておくと記述の幅が広がるよ！

