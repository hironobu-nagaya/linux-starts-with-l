chapter=5
story=22
title=アーカイブ
keyword=archive
keyword=tar
prev=5/21/
prev-title=メッセージ(実践)
next=5/23/
next-title=ビルド(手順)

# アーカイブ

みどり（通常）：
  お兄ちゃん！
  ZIP を扱うことがあるんだけど
  Linux でも似たようなものは
  あるのかな？
しげる（通常）：
  もちろんあるよ！
  今回は「アーカイブ(archive)」
  について学ぼう！
みどり（通常）：
  アーカイブ？
  圧縮と何が違うんだろう？

## 基本

しげる（通常）：
  ZIP は複数のファイルを
  まとめて1つにして
  それを圧縮する仕組みだよね
みどり（通常）：
  うん！
  1ファイルになって
  ファイルサイズも小さくなるから
  メール添付とかでよく使うよ！
しげる（通常）：
  でも Linux では
  「複数のファイルを1つにまとめる」と
  「圧縮する」を別々の機能と考えるんだ

機能       | 役割
---------- | ----
アーカイブ | 複数のファイルやディレクトリを1つのファイルにまとめること
圧縮       | ファイルサイズを小さくすること

みどり（通常）：
  なるほど！
  ZIP は1つの作業に見えるけど
  Linux では2つの作業として
  分けているんだね
しげる（通常）：
  今回は Linux で標準的なアーカイブ
  「tar アーカイブ」を扱っていこう！

## アーカイブ作成

しげる（通常）：
  `tar` は
  「tar アーカイブ」を管理するよ

```bash
tar [オプション]... [ファイル]...
```

オプション | 役割
---------- | ----
`c`        | アーカイブを作成する(create)
`f`        | 作成するアーカイブを指定する(file)

しげる（通常）：
  以下の例を
  実行してみよう！

```bash
tar cf my-directory.tar my-directory
```

みどり（通常）：
  これは `my-directory` ディレクトリを
  `my-directory.tar` アーカイブに
  まとめているんだね
しげる（通常）：
  そうだよ
  ただしこの時点では
  ファイルサイズは変わっていないよ
  アーカイブは「まとめる」だけだからね
みどり（通常）：
  じゃあ圧縮は
  どうするのかな？

## 圧縮オプション

しげる（通常）：
  圧縮は `tar` に
  オプションを追加するよ

オプション | 圧縮形式 | 拡張子 | 特徴
---------- | -------- | ------ | ----
`z`        | GZIP     | `.gz`  | そこそこの圧縮率で処理速度が速い
`j`        | BZIP2    | `.bz2` | 圧縮率と処理速度のバランスが良い
`J`        | XZ       | `.xz`  | 高圧縮率だが処理速度はやや遅い

しげる（通常）：
  これらの圧縮オプションを
  使った例を見てみよう

圧縮形式 | コマンド
-------- | --------
GZIP     | `tar cfz my-directory.tar.gz my-directory`
BZIP2    | `tar cfj my-directory.tar.bz2 my-directory`
XZ       | `tar cfJ my-directory.tar.xz my-directory`

みどり（通常）：
  拡張子が
  `.tar` と `.gz` が合わさって
  `.tar.gz` のようになっているね
しげる（通常）：
  このような拡張子を
  二重拡張子というんだ
  「tar アーカイブ」は
  二重拡張子が一般的だよ
みどり（笑顔）：
  二重拡張子って
  付けたことがないなぁ
  ちょっと新鮮で面白いね！

## アーカイブ展開

しげる（通常）：
  アーカイブの展開には
  以下のオプションを
  指定するよ

オプション | 役割
---------- | ----
`x`        | アーカイブを展開する(extract)
`f`        | 展開するアーカイブを指定する(file)

```bash
tar xf my-directory.tar.gz
```

みどり（通常）：
  圧縮オプションは
  付けなくても
  いいのかな？
しげる（通常）：
  拡張子から圧縮形式を
  自動で判別してくれるんだ
  だから圧縮オプションは
  指定しなくても問題ないよ
みどり（通常）：
  拡張子を見て自動で
  判断してくれるなんて
  親切だね！

## tarball

しげる（通常）：
  こうやって `tar` で
  アーカイブし圧縮したファイルを
  「ターボール(tarball)」と言うんだ
みどり（通常）：
  良く扱うから
  通称がついているんだ！
しげる（通常）：
  Linux のソフトウェアやソースコードは
  tarball 形式で配布されることが多いんだ
みどり（通常）：
  通常の圧縮や展開の用途だけでなく
  Linux を扱う上で
  大切なスキルなんだね！

## まとめ

みどり（通常）：
  今回はアーカイブについて学んだよ！
  `tar` で作成や展開を行うんだ！
しげる（通常）：
  Windows や macOS にも tarball を
  解凍できるソフトウェアがあるので
  Linux から他の OS へ
  ファイルを送るのにも使えるよ！

