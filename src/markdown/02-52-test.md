chapter=2
story=52
title=testコマンド
keyword=test
prev=2/51/
prev-title=終了ステータス
next=2/53/
next-title=AND演算子とOR演算子

# `test` コマンド

みどり（通常）：
  終了ステータスの使い方って気になるなぁ
しげる（通常）：
  今回は終了ステータスと
  密接な関わりを持つ `test` を学ぼう！

## 使い方

しげる（通常）：
  `test` は指定した条件を調べて
  結果を終了ステータスで返すよ

```bash
test [オプション]...
```

しげる（通常）：
  `-d` オプションは
  「ディレクトリが存在しているか」
  をチェックするよ
しげる（通常）：
  以下のコマンドを
  実行してみよう

```bash
test -d /home/midori
```

みどり（通常）：
  実行したけど
  何も表示されないね
しげる（通常）：
  結果は画面出力ではなく
  終了ステータスで返されているんだ
  終了ステータスを確認してみよう！

```bash
echo $?
```

みどり（通常）：
  終了ステータスは
  `?` 変数に格納されるんだよね！

```console
0
```

みどり（通常）：
  `0` が表示されたよ！
  ということは成功だね！
  これで
  「`/home/midori` ディレクトリが存在している」
  ことがわかるんだ！
しげる（通常）：
  そういうことだね！
  `test` は条件が満たされていれば `0`
  そうでなければ `1` を返すよ
しげる（通常）：
  今度は `-f` オプションを使ってみよう
  これは「通常ファイルが存在しているか」を
  チェックするオプションだよ
  同じように以下を実行してみよう

```bash
test -f /home/midori
```

みどり（通常）：
  実行したよ！

```bash
echo $?
```

みどり（通常）：
  結果は終了ステータスで
  返って来ているんだよね！

```console
1
```

みどり（通常）：
  今度は `1` が表示された！
  `/home/midori` はディレクトリだから
  通常のファイルじゃないってことだね
しげる（通常）：
  そういうことだね
  `test` はこうやって
  条件を調べるのに
  使われるんだ

## `[` コマンド

しげる（通常）：
  `test` は
  よく使われるコマンドなんだ
  そのため簡単に使える別名
  `[` が用意されているよ
みどり（驚き）：
  コマンドに別名があるの？
  それは初耳！
しげる（通常）：
  さっきの `test -d /home/midori` を
  `[` を使って書き換えてみよう
しげる（通常）：
  ただし `[` を使う場合は
  最後を `]` で閉じるという
  ルールがあるんだ
  だからこのように書くよ

```bash
[ -d /home/midori ]
```

みどり（通常）：
  なんだか
  「ひとまとまりの条件」
  というのがわかりやすいね！
しげる（通常）：
  じゃあ終了ステータスを
  確認してみようか

```bash
echo $?
```

みどり（通常）：
  `test` と `[` は
  同じものだから
  結果は `0` だと思うなぁ

```console
0
```

みどり（笑顔）：
  ちゃんと `test` と
  同じ結果だね！
しげる（通常）：
  たいていの場面で
  `test` よりも
  `[` が使われるよ
  この書き方に慣れておこう！

## オプション

しげる（通常）：
  `test` でよく使う
  指定をまとめたよ！

コマンド             | 説明
-------------------- | ----
`[ -d PATH ]`        | パス `PATH` がディレクトリであれば成功
`[ -f PATH ]`        | パス `PATH` が通常ファイルであれば成功
`[ -e PATH ]`        | パス `PATH` が存在していれば成功
`[ X -eq Y ]`        | 数値 `X` と `Y` が等しければ成功
`[ X -ne Y ]`        | 数値 `X` と `Y` が異なれば成功
`[ X -gt Y ]`        | 数値 `X` が `Y` より大きければ成功
`[ X -ge Y ]`        | 数値 `X` が `Y` より大きいか等しければ成功
`[ X -lt Y ]`        | 数値 `X` が `Y` より小さければ成功
`[ X -le Y ]`        | 数値 `X` が `Y` より小さいか等しければ成功
`[ -n TEXT ]`        | 文字列 `TEXT` の長さが1以上なら成功
`[ -z TEXT ]`        | 文字列 `TEXT` の長さが0なら成功
`[ TEXT1 == TEXT2 ]` | 文字列 `TEXT1` と `TEXT2` が等しければ成功
`[ TEXT1 != TEXT2 ]` | 文字列 `TEXT1` と `TEXT2` が異なれば成功
`[ ! 条件 ]`         | `条件` が失敗なら成功
`[ 条件1 -a 条件2 ]` | `条件1` と `条件2` が両方成功なら成功
`[ 条件1 -o 条件2 ]` | `条件1` と `条件2` のどちらかが成功なら成功

みどり（驚き）：
  うわぁ！
  いっぱいある！
しげる（通常）：
  本当はもっとあるけど
  必要になったら少しづつ
  覚えればいいよ

## まとめ

みどり（通常）：
  今回は `test` と
  その別名 `[` を覚えたよ！
  色々な条件を判定して
  終了ステータスで
  結果を教えてくれるんだ！
しげる（通常）：
  `test` でチェックした条件は
  この後で教える方法で使えるよ！
  その基礎になるから
  しっかりおさえておこう！

