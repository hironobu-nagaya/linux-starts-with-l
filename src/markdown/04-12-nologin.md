chapter=4
story=12
title=nologin
prev=4/11/
prev-title=特殊なパーミッション操作
next=4/13/
next-title=マウント

# nologin

しげる（通常）：
  今回は `nologin` を覚えよう！
みどり（通常）：
  `no` と `login` を
  つなげた言葉だね
  「ログインしないこと」
  についての何かかな？

## `/sbin/nologin` コマンド

しげる（通常）：
  まずは `nologin` コマンドだよ
  これは `/sbin` ディレクトリにあるんだ
みどり（通常）：
  スーパーユーザ専用のコマンドが
  置かれているディレクトリにあるんだね！
しげる（通常）：
  `nologin` は
  メッセージを表示して
  接続を切断するよ
みどり（通常）：
  どうやって使うものなのかな？
しげる（通常）：
  ログインしないユーザの
  ログインシェルに
  指定しておくものだよ
みどり（通常）：
  ログインシェルが
  `/sbin/nologin` に
  設定されているユーザは
  仮にログインができたとしても
  メッセージが表示されて
  すぐに接続が切断されるんだね

## `/etc/nologin` ファイル

しげる（通常）：
  `/sbin/nologin` コマンドとは別に
  `/etc/nologin` ファイルも重要だよ
みどり（通常）：
  `/etc` は設定ファイルが
  置かれているディレクトリだね！
しげる（通常）：
  `/etc/nologin` ファイルがあると
  スーパーユーザ以外は
  いっさいログインできなくなるよ
みどり（通常）：
  よほど重要なときに
  使うのかな？
しげる（通常）：
  そうだね
  スーパーユーザ以外が活動して
  システムの状態や内容を
  変更されては困るような場合に使うよ
  たとえば緊急メンテナンスとかだね
みどり（通常）：
  ファイルの内容は
  どうすればいいのかな？
しげる（通常）：
  `/etc/nologin` は
  ファイルが存在しているだけで
  その効果を発揮するよ
  なので内容は関係ないんだ
  通常は空ファイルを作るよ
みどり（通常）：
  つまり `touch` で
  作ればいいんだね！

```bash
sudo touch /etc/nologin
```

しげる（通常）：
  そうだね
  作ったままだと他のユーザが
  ログインできないので
  必要が無くなったら
  削除するのを忘れないようにね

```bash
sudo rm /etc/nologin
```

しげる（通常）：
  ディストリビューションによっては
  再起動などのタイミングで
  `/etc/nologin` を
  削除してくれるものもあるよ
  詳しくは自分の使っている
  ディストリビューションを確認しよう！

## まとめ

みどり（通常）：
  今回は `nologin` を学んだよ！
  コマンドとファイルの二つがあるんだ！

パス            | 役割
--------------- | ----
`/sbin/nologin` | ログインしないユーザのシェルの代わりに指定されるコマンド
`/etc/nologin`  | このファイルがあるとスーパーユーザ以外をログインさせない

しげる（通常）：
  両方の `nologin` は
  スーパユーザが
  管理するものだよ！

