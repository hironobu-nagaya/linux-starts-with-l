chapter=4
story=23
title=強制アクセス制御
keyword=super user
keyword=root
keyword=mandatory access control
keyword=mac
keyword=SELinux
keyword=AppArmor
keyword=TOMOYO Linux
prev=4/22/
prev-title=PAM
next=5/1/
next-title=個人設定

# 強制アクセス制御

しげる（通常）：
  今回は「強制アクセス制御
  (mandatory access control, MAC)」
  を知ろう！
みどり（驚き）：
  なんだか
  すごそうな
  名前だね！

## 概要

しげる（通常）：
  Linux の基本的なアクセス制御は
  「パーミッション」なんだ
しげる（通常）：
  パーミッションのように
  アクセス制御対象の所有者が
  自分で制御を決められる方式を
  「任意アクセス制御
  (discretionary access control, DAC)」
  とよぶよ
みどり（通常）：
  ファイル所有者が `chmod` で
  パーミッションを設定できるよね
  確かに「任意」の
  アクセス制御だと思う！
みどり（通常）：
  パーミッションは
  仕組みは簡単だけど
  ちゃんとアクセス制御が
  できているよね？
しげる（通常）：
  でも色々な使われ方を
  しているうちに
  パーミッションだけでは
  不十分な場合も出てきたんだ
みどり（通常）：
  それはどんな場合かな？
しげる（通常）：
  たとえばみどりの
  ゲームサーバプログラムが
  悪意あるユーザに
  乗っ取られたとしよう
みどり（通常）：
  たまに耳にする
  「任意のコードを
  実行できる脆弱性」
  とかというものとかだよね！
しげる（通常）：
  その悪意あるユーザは
  ゲームサーバプロセス実行者の権限で
  そこからほとんどのコマンドを
  実行できてしまうんだ
みどり（通常）：
  ほとんどのコマンドは
  パーミッションで誰でも
  実行を許しているからね
  確かにそうなっちゃうね
しげる（通常）：
  そこでゲームサーバのプロセスや
  ゲームサーバの実行者などに
  以下のような制限を
  設けられたらどうだろう？

* ゲームサーバに関係あるコマンドだけ実行できる
* ゲームサーバに関係あるディレクトリ配下のみアクセスできる
* ゲームサーバが扱う設定ファイルのみ読み込みできる
* ゲームサーバが扱うデータファイルのみ読み書きできる
* ゲームサーバが使うポートのみ使用できる

みどり（笑顔）：
  良さそうな仕組みだね！
  仮にゲームサーバが乗っ取られても
  ゲームサーバ本来の動作以外は
  実質何もできなくなっちゃう！
しげる（通常）：
  このようにアクセス制御対象を
  所有者ではなくシステムが管理して
  できることできないことを
  強制するアクセス制御を
  「強制アクセス制御」とよぶよ
みどり（通常）：
  とても強力な
  アクセス制御なんだね！

## 実装

しげる（通常）：
  強制アクセス制御の実装には
  以下のようなものがあるよ

実装                                            | 説明                           | 採用しているディストリビューション
----------------------------------------------- | ------------------------------ | ----------------------------------
[SELinux](https://selinuxproject.org/)          | 細く設定できるが難しい         | Red Hat 系([CentOS](https://www.centos.org), [Fedora](https://fedoraproject.org/ja/) など)
[AppArmor](https://apparmor.net)                | 簡単に使えることを目指している | Debian 系([Debian](https://www.debian.or.jp), [Ubuntu](https://ubuntulinux.jp) など)
[TOMOYO Linux](https://tomoyo.sourceforge.net/) | 動作の学習から設定を作成する   | (あまり採用例がない)

しげる（通常）：
  強制アクセス制御の実装は
  ディストリビューションに
  含まれている場合がほとんどなんだ
  なのでディストリビューションの
  デフォルトを使うのが無難だよ
みどり（通常）：
  強制アクセス制御は
  どうやって設定すれば
  いいのかな？
しげる（通常）：
  強制アクセス制御の設定は複雑で難しく
  強制アクセス制御の実装によっても変わるんだ
  なのでここでは紹介だけに留めておくね

## まとめ

みどり（通常）：
  今回は強制アクセス制御を学んだよ！
  パーミッションではできなかった
  細かなアクセス制御を指定できるんだ！
しげる（通常）：
  強制アクセス制御は簡易な解説では
  「最初にオフにしましょう」と
  書かれてしまうぐらい
  難しい話題なんだ
しげる（通常）：
  でもちゃんと設定すれば
  強固なセキュリティを
  確保できる仕組みだよ！

