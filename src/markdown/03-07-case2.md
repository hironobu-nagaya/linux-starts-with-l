chapter=3
story=7
title=case文(実践)
keyword=shell script
keyword=case
prev=3/6/
prev-title=case文(使い方)
next=3/8/
next-title=for文(使い方)

# `case`文(実践)

みどり（通常）：
  前回は`case`文の
  使い方を学んだね！
しげる（通常）：
  今回は`case`で
  シェルスクリプトを
  書いていこう！

## 実践

しげる（通常）：
  おみくじの改良版
  `omikuji2` を作ろう！
  エディタを開いて
  準備してね

```bash
vim omikuji2
```

みどり（笑顔）：
  うん！
  どんな内容か楽しみ！
しげる（通常）：
  内容は以下のとおりだよ！

```bash
#!/bin/bash

OMIKUJI="$((RANDOM % 10))"

case "$OMIKUJI" in
  0)
    echo "大吉"
    ;;
  1|2)
    echo "中吉"
    ;;
  3|4|5)
    echo "小吉"
    ;;
  *)
    echo "吉"
    ;;
esac
```

----

みどり（通常）：
  算術式展開 `$(( ... ))` で
  `RANDOM` 変数を使っているね
  `RANDOM` 変数を
  いきなり使っているけど
  大丈夫なのかな？

```bash
OMIKUJI="$((RANDOM % 10))"
```

しげる（通常）：
  `RANDOM` 変数は
  シェルが用意している
  特別な変数だよ
  値を参照するたびに
  0以上のランダムな
  数値を返すんだ
みどり（通常）：
  じゃあここの算術式展開では
  ランダムな数を 10 で割った
  余りを求めているんだね！
みどり（通常）：
  でも…
  どうして余りを
  使うんだろう？
しげる（通常）：
  10 で割れば余りは
  0 から 9 までの
  10 通りになるんだ
しげる（通常）：
  `RANDOM` 変数は
  大きな範囲の数を出すけど
  剰余を使えば簡単に
  範囲を絞れるんだよ
みどり（驚き）：
  なるほど！
  ランダムな値を
  0 から 9 の範囲に
  絞っているのね！

----

しげる（通常）：
  いよいよ
  `case`文に
  入っていくよ

```bash
case "$OMIKUJI" in
  0)
    echo "大吉"
    ;;
  1|2)
    echo "中吉"
    ;;
  3|4|5)
    echo "小吉"
    ;;
  *)
    echo "吉"
    ;;
esac
```

みどり（通常）：
  これは分かりやすいね！
  `OMIKUJI` 変数の値によって
  条件が分かれていて
  それぞれの処理で
  おみくじの結果を
  表示しているんだね

`OMIKUJI` 変数の値           | 表示される内容
---------------------------- | --------------
`0`                          | 大吉
`1`, `2`                     | 中吉
`3`, `4`, `5`                | 小吉
上記以外(`6`, `7`, `8`, `9`) | 吉

しげる（通常）：
  そのとおり！
  `1|2)` と書けば「1または2」だし
  `*)` を使えば「どの条件にも
  当てはまらなかった場合」と
  わかりやすく書けるんだ

## まとめ

みどり（通常）：
  今回は`case`文を使って
  シェルスクリプトを書いたよ！
みどり（笑顔）：
  最初に書いたおみくじは
  結果を 10 行生成して
  9 行捨てていたけど
  今回はスッキリしていて
  効率的だね！
しげる（通常）：
  こんなふうにいくつか分岐があって
  その中から一つ処理を選ぶという場合は
  `case`文が有効に使えるよ

