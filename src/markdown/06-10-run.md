chapter=6
story=10
title=/runディレクトリ
keyword=directory
keyword=run
keyword=PID
keyword=socket
keyword=FIFO
prev=6/9/
prev-title=バイナリログ
next=6/11/
next-title=systemd-timesyncd

# `/run` ディレクトリ

みどり（通常）：
  お兄ちゃん！
  そういえば `/run` には
  動作しているサーバプログラムの
  情報があるんだよね？
しげる（通常）：
  そうだね！
  今回は `/run` の
  中を覗いてみよう！

## PID ファイル

みどり（通常）：
  拡張子 `.pid` の
  ファイルが多くて目立つね！

```console
プログラム名.pid
```

しげる（通常）：
  このファイルは
  PID ファイルと呼ばれるよ
  通常のテキストファイルで
  内容にそのプログラムの
  PID が書かれているんだ
みどり（通常）：
  どうやって使うものなのかな？
しげる（通常）：
  PID を簡単に取得するために
  用意されているんだ
  例えば以下のように使うよ

```bash
kill "$(cat /run/crond.pid)"
```

みどり（通常）：
  `crond.pid` の内容を表示して
  `crond` の PID を取り出して
  使っているんだね！

## ソケットファイル

みどり（通常）：
  拡張子が `.sock` や `.socket` の
  ファイルもあるみたいだよ！
しげる（通常）：
  これらはソケットファイルと呼ばれるよ
  このファイルを介して
  プロセス同士が通信するんだ
しげる（通常）：
  このファイルは今の段階では
  役割だけ覚えておけば十分だよ！

## FIFO ファイル

みどり（通常）：
  上記以外にもまだファイルがあるみたいだね！
  特に拡張子は付いていないけどなんだろう？
しげる（通常）：
  これらは
  「FIFO (first-in first-out)ファイル」の場合が多いよ
  「名前付きパイプ(named pipe)」とも呼ばれるよ
みどり（通常）：
  これも初めて聞くものだね
しげる（通常）：
  パイプをファイル経由で
  使えるようにするものなんだ
  このファイルから
  入力リダイレクトして待機しておくと
  このファイルへ書き込みがあったときに
  その内容が読み込まれるというものだよ
みどり（通常）：
  へぇ…
  面白い動きをするファイルだね！
しげる（通常）：
  FIFO ファイルは自分で作成することもできるよ
  使う機会はめったにないけど紹介しておくね
しげる（通常）：
  `mkfifo` は
  FIFO ファイルを作成するんだ

```bash
mkfifo [オプション]... ファイル...
```

## まとめ

みどり（通常）：
  今回は `/run` にあるファイルを学んだよ！
  サーバプログラムなど動き続けるプログラムが
  以下のようなファイルを作ってくれているんだ

ファイル         | 役割
---------------- | ----
PID ファイル     | 内容に PID が書かれているテキストファイル
ソケットファイル | プロセスがソケット通信を行うためのファイル
FIFO ファイル    | 名前付きパイプを扱うファイル

しげる（通常）：
  PID ファイルは
  例で示したような使われ方をされるよ
  他は「このような役割なんだ」と
  理解しておけば今は十分だよ！

