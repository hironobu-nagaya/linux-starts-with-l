chapter=2
story=33
title=ヒアドキュメント
keyword=here docment
keyword=here string
prev=2/32/
prev-title=ファイルディスクリプタ
next=2/34/
next-title=パイプ

# ヒアドキュメント

みどり（通常）：
  お兄ちゃん！
  出力リダイレクトには
  `>` と `>>` があったけど
  入力リダイレクトって `<` だけなのかな？
  `<<` とかあってもよいんじゃないかなと思ったの
しげる（通常）：
  実は `<<` という
  リダイレクト記号があるよ
  でも `>>` のように追記の意味はないんだ
  これは「ヒアドキュメント(here document)」
  と呼ばれているよ
みどり（笑顔）：
  リダイレクトが便利だったので
  ヒアドキュメントも
  きっと役に立ちそうだね！

## 使い方

しげる（通常）：
  ヒアドキュメントは
  複数行のテキストを
  そのままコマンドの入力として
  渡せる仕組みなんだ
みどり（通常）：
  へぇ…
  それってどうやるのかな？
しげる（通常）：
  以下を入力してみよう！

```bash
cat << EOF
```

みどり（通常）：
  `cat` は「ファイルの内容を表示」だよね
  何を表示してくれるんだろう？

```console
> !cursor!
```

みどり（驚き）：
  あれ？
  いつものプロンプト `$` じゃなくて
  代わりに `>` が出てきたよ！

しげる（通常）：
  これはまだコマンドが完了しておらず
  入力を待っている状態を表しているよ
しげる（通常）：
  `>` に続けて好きな内容を
  何行か入力してみて
みどり（通常）：
  こんな感じ？

```console
> まいやひ
> まいやふ
> まいやほ
```

しげる（笑顔）：
  いい感じだね！
しげる（通常）：
  最後に入力の終わりを示す `EOF` を入れよう
  `EOF` とだけ入力したら Enter だよ！

```console
> EOF
```

みどり（通常）：
  ここで Enter っと！

```console
まいやひ
まいやふ
まいやほ
```

みどり（驚き）：
  おおっ！
  これまで入力した内容が
  そのまま出力されたよ！
  まるで `echo` の
  複数行版みたいだね！
しげる（通常）：
  ヒアドキュメントは `<<` の後に
  「終了を表す文字列」を指定することで
  その文字列が出るまでの全ての行を
  コマンドの入力として扱うんだよ
みどり（通常）：
  ところで `EOF` って
  どういう意味なのかな？
しげる（通常）：
  `EOF` は「End Of File(ファイルの終わり)」の略だよ
  だけど実際はなんでもいいんだ
  「終わり」が分かりやすい単語なら使いやすいね
  `EOI`(End Of Input) や `END` を使う人も多いよ
みどり（通常）：
  なるほど！
  `EOF` に限らず好きな文字列を
  「終了を表す文字列」にできるんだね

## 内容のクォート

しげる（通常）：
  ヒアドキュメントの内容は
  「ダブルクォート(`"`)」で
  クォートしたような扱いになるよ
みどり（通常）：
  「ゆるい」クォートだよね
  一部の特殊な記号しか
  意味を失わせてくれないんだ
しげる（通常）：
  以下のようにすることで
  ヒアドキュメントの内容を
  「きつく」クォートできるんだ

```bash
cat << \EOF
...
EOF
```

```bash
cat << 'EOF'
...
EOF
```

みどり（通常）：
  へぇ！
  逆にいうとこの書き方をしなければ
  大部分の特別な記号は
  そのままの意味を持つんだね
しげる（通常）：
  それが便利な場合もあるけど
  不都合ならクォートして
  そのままの内容を出力させよう

## 出力リダイレクトとの組み合わせ

しげる（通常）：
  じゃあちょっと発展的な
  使い方をしてみようか
しげる（通常）：
  ヒアドキュメントを使って
  入力を作りつつ
  出力をリダイレクトして
  ファイルに保存してみよう
しげる（通常）：
  以下をそのまま
  入力してみてね

```bash
cat > my-song << EOF
まいやひ
まいやふ
まいやほ
EOF
```

みどり（通常）：
  わかった
  やってみるね！
しげる（通常）：
  そうしたら
  `my-song` の
  中身を確認しよう

```bash
cat my-song
```

みどり（通常）：
  どうなるんだろうね？

```console
まいやひ
まいやふ
まいやほ
```

みどり（驚き）：
  …すごい！
  `my-song` ファイルに
  ヒアドキュメントの
  3行が保存されている！
みどり（笑顔）：
  これ…
  エディタなしで
  簡単にテキストファイルが
  作れちゃんだね！
しげる（通常）：
  ヒアドキュメントは
  手軽にテキストを
  扱いたい時に便利だよ
みどり（通常）：
  `>` の代わりに `>>` として
  追記でもできるんだよね？
しげる（笑顔）：
  もちろん！

## ヒアストリング

しげる（通常）：
  入力が1行の場合
  「ヒアストリング(here string)」
  を使うと便利なんだ
  書き方はこうだよ

```bash
コマンド <<< 文字列
```

みどり（通常）：
  1行入力に特化した
  ヒアドキュメントという感じだね
  「終了を表す文字列」の指定もいらないし
  こっちで書ける場合は
  記述が少なくて見やすいね！

## まとめ

みどり（通常）：
  今回はヒアドキュメントと
  ヒアストリングの使い方を学んだよ！
しげる（通常）：
  ヒアドキュメントやヒアストリングは
  簡単にコマンドの入力を
  生成できる便利な記述だよ
  これを覚えておけば
  操作の幅がもっと広がるよ！

