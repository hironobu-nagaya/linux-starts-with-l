chapter=2
story=25
title=パーミッション
keyword=ownership
keyword=permission
keyword=mode
keyword=ls
prev=2/24/
prev-title=マニュアル
next=2/26/
next-title=パーミッション操作

# パーミッション

みどり（笑顔）：
  えへへ…
  お兄ちゃんがいない間に
  `/home/shigeru` を覗いてみよう！

```bash
ls /home/shigeru
```

```console
ls: cannot open directory '/home/shigeru': Permission denied
```

みどり（驚き）：
  「Permisson Denied」？
  「許可されていない」って意味だよね？
  秘密のロックでも掛けているのかな？
しげる（通常）：
  実は特別なことをしなくても
  ファイルやディレクトリが
  守られているんだ
みどり（驚き）：
  わぁ！
  ごめんなさい！
しげる（通常）：
  今回は「所有権(ownership)」と
  「パーミッション(permission)」の
  二つを学ぼう！
みどり（通常）：
  …えっ？
  「所有権」と…
  「パーミッション」？

## 所有権

しげる（通常）：
  まずは「所有権」から見ていこう
  これはファイルの所有者を
  表している概念なんだ
  ファイルすべてに設定されているよ
みどり（驚き）：
  ファイルに所有者が
  設定されていたんだ？！
しげる（通常）：
  `/home` 以下のディレクトリを確認しよう
  ただし `ls` の `-l` オプションを指定してね

```bash
ls -l /home
```

みどり（通常）：
  名前だけじゃなく色々な情報を
  表示するオプションだったよね！

```console
total 5
drwx------. 9 midori  midori  4096 Dec 28 20:48 midori
drwx------. 9 shigeru shigeru 4096 Dec 25 12:15 shigeru
```

みどり（通常）：
  `midori` ディレクトリの追加情報に
  `midori` って私の名前が2回出てるけど
  これは何かな？
しげる（通常）：
  これらが「所有権」を表しているよ
  1つ目は所有ユーザ
  2つ目は所有グループなんだ
しげる（通常）：
  ちなみに「グループ(group)」は
  複数のユーザをまとめる仕組みだよ
  今はそれほど気にしなくても大丈夫
みどり（通常）：
  「所有権」は
  「所有ユーザ」と
  「所有グループ」を
  合わせたものなんだね！

## パーミッション

しげる（通常）：
  次にこの部分を見てごらん

```console
drwx------
```

みどり（通常）：
  えーっと…
  これは何？
しげる（通常）：
  これは「パーミッション」という
  ファイル操作の許可を表しているんだ
しげる（通常）：
  最初の `d` は
  ディレクトリであることを
  示しているんだ
しげる（通常）：
  でも、それ以外の部分が重要だよ
みどり（通常）：
  重要なのは…
  後ろの9文字？

```console
rwx------
```

しげる（通常）：
  この9文字は3文字ずつに区切って考えるんだ
  最初の3文字は所有ユーザ
  次の3文字は所有グループ
  最後の3文字はその他のユーザ
  つまり他人に対する許可を表しているよ
みどり（通常）：
  3文字ずつか…
  なるほど…

```console
rwx  ---  ---
```

しげる（通常）：
  それぞれの文字は
  以下を表しているよ

文字 | 意味
---- | ----
`r`  | 読み込み(read)
`w`  | 書き込み(write)
`x`  | 実行（execute)
`-`  | 許可がない

みどり（通常）：
  「読み込み」「書き込み」は
  なんとなくわかるけど…
  「実行」ってどういう意味？
しげる（通常）：
  ファイルの場合は
  それをプログラムとして
  実行できるという意味だよ
しげる（通常）：
  ディレクトリの場合は
  意味が違っているんだ
  ディレクトリの中身を調べたり
  アクセスできることを意味しているよ
みどり（通常）：
  ディレクトリの
  「読み込み」と「実行」の
  違いがよくわからないね…
しげる（通常）：
  両者は厳密には違うんだけど
  以下のように両方同時に
  指定すると覚えておこう！

ディレクトリへのアクセス | 指定
------------------------ | ----
許可したい               | 「読み込み」と「実行」の両方の権限を与える
拒否したい               | 「読み込み」と「実行」の両方の権限を除く

みどり（通常）：
  うーん…
  ちょっと難しいけど
  整理すればわかるかも
しげる（通常）：
  じゃあ一緒に
  `rwx------`
  の部分を見てみよう

```console
rwx------
```

```console
rwx --- ---
```

しげる（通常）：
  最初の `rwx` は所有ユーザの
  権限を表しているんだ

```console
rwx
```

しげる（通常）：
  つまり midori ユーザは
  「読み」「書き」「実行」を
  自由にできるというわけだね
みどり（通常）：
  自分のディレクトリだから
  何でもできるという設定なんだ！
しげる（通常）：
  次の `---` は所有グループの権限だね

```console
---
```

しげる（通常）：
  これは「何も許可されていない」
  ことを示しているんだ
みどり（通常）：
  `midori` ユーザ本人じゃないと
  たとえ `midori` グループに所属していても
  何の権限もないことになるんだね！
しげる（通常）：
  そして最後の `---` は
  他人に対する権限だったね

```console
---
```

しげる（通常）：
  所有グループと同じく
  何も許可していないね
  つまり僕みたいなユーザに対して
  何も許可していないという設定になっているよ
みどり（通常）：
  そういうことなんだ！
  だから私が `/home/shigeru` を
  覗こうとしたとき
  実行や読み込み権限が無くて
  Permission Denied って出たんだね
しげる（通常）：
  「パーミッション」は
  「モード(mode)」とも呼ぶんだ
  こちらで呼ぶこともあるので
  一緒に覚えておこう！

## まとめ

みどり（通常）：
  「所有権」と「パーミッション」で
  ファイルやディレクトリの操作を
  制限しているんだね！
しげる（通常）：
  最初のうちは難しく感じるけど
  慣れればすぐ読めるようになるよ
しげる（通常）：
  いろんなファイルやディレクトリで
  `ls -l` を試して読み方を練習しておこう！

