chapter=2
story=31
title=リダイレクト
keyword=redirect
keyword=echo
prev=2/30/
prev-title=クォート
next=2/32/
next-title=ファイルディスクリプタ

# リダイレクト

しげる（通常）：
  今回は「リダイレクト(redirect)」
  について学んでみよう
  名詞で「リダイレクション
  (redirection)」とも呼ぶよ
みどり（通常）：
  リダイレクト？
  それってどんな
  ものなのかな？
しげる（通常）：
  普通はキーボードから入力して
  結果が画面に出力されるよね
しげる（通常）：
  この「普通」を変更して
  出力先や入力元を自由に
  変えられる機能なんだよ
みどり（通常）：
  うーん…
  ピンと来ないなぁ…

## 出力リダイレクト

しげる（通常）：
  `echo` は
  文字列を画面に表示するよ

```bash
echo [オプション]... 文字列...
```

オプション | 役割
---------- | ----
`-n`       | 出力の最後に改行を付けない
`-e`       | 「バックスラッシュ(`\`)」によるエスケープを解釈する ( `\n` で「改行」など)

しげる（通常）：
  以下を実行してみよう！

```bash
echo hello
```

みどり（通常）：
  どれどれ？

```console
hello
```

みどり（驚き）：
  おおっ！
  画面に `hello` って
  表示されたよ！
みどり（笑顔）：
  「こだま(echo)」だから
  この名前なんだね！
みどり（通常）：
  でも画面に文字が
  表示されるだけって
  あまり使い道が
  思い浮かばないかも
しげる（笑顔）：
  後になると色々な
  使い道が出てくるから
  楽しみにしていてね
しげる（通常）：
  じゃあその
  「画面に出力される」
  の動きを変えてみよう
  このように書くよ

```bash
コマンド > ファイル
```

しげる（通常）：
  `echo` では
  以下のように
  してみよう

```bash
echo hello > my-file
```

みどり（通常）：
  あれ？
  今度は何にも
  表示されないよ？
しげる（通常）：
  そう
  文字列 `hello` の出力先は
  画面じゃないんだ
しげる（通常）：
  `ls` で
  ファイル一覧を
  確認してみよう！

```bash
ls
```

みどり（通常）：
  あっ

```console
my-file
```

みどり（通常）：
  `my-file` という
  ファイルがある！

```bash
cat my-file
```

みどり（通常）：
  この中身って
  もしかして…

```console
hello
```

みどり（驚き）：
  中身が `hello` に
  なっている！
しげる（通常）：
  画面に出力されるはずの
  文字列 `hello` を
  リダイレクトで変更して
  `my-file` ファイルに
  出力させたんだよ
みどり（笑顔）：
  すごい！
  1行の文章なら
  エディタを使わなくても
  ファイルに保存できるね！
しげる（通常）：
  注意があるよ
  `>` を使うと
  指定されたファイルの中身を**全部消してから**
  新しい出力を書き込むんだ
みどり（通常）：
  出力先に上書きする
  動作になるんだね
  すでに内容があるファイルに
  追記はできないのかな？
しげる（通常）：
  できるよ！
  既に内容があるファイルに
  **追記**したい場合には `>>` を使うよ

```bash
コマンド >> ファイル
```

みどり（通常）：
  なるほど！
  「`>` は上書き」
  「`>>` は追記」だね！
みどり（笑顔）：
  じゃあ `my-file` ファイルに
  どんどん内容を追記してみよう！

```bash
echo hello2 >> my-file
echo hello3 >> my-file
echo hello4 >> my-file
```

## `/dev/null` ファイル

しげる（通常）：
  出力リダイレクトを覚えたら
  `/dev/null` も一緒に覚えよう！
みどり（通常）：
  ええっと…
  FHS のときに出てきたよね？
  たしか「常に空っぽ」の
  ファイルだったと思う！
しげる（通常）：
  そのとおり！
  何をしても「常に空っぽ」なんだ
  出力リダイレクトと組み合わせて
  「出力のゴミ箱」として利用されるよ

```bash
コマンド > /dev/null
```

みどり（通常）：
  出力メッセージを
  出して欲しくない場合は
  このようにするのね！

## 入力リダイレクト

しげる（通常）：
  リダイレクトは
  入力元も変更できるよ

```bash
コマンド < ファイル
```
しげる（通常）：
  `コマンド` が
  キーボード入力の代わりに
  `ファイル` の内容を入力に使うよ
みどり（通常）：
  あらかじめファイルに
  入力内容を書いておいて
  入力リダイレクトすれば
  キーボード操作を
  自動化できるんだね！
しげる（通常）：
  そのとおり！
  今の段階では使い道が
  思い浮かばないかも知れないけど
  さまざまな場面で役立つから覚えておこうね

## まとめ

みどり（通常）：
  今回はリダイレクトを覚えたよ！
  以下のようにすれば
  出力先や入力元を変更できるんだ！

記述                   | 動作
---------------------- | ----
`コマンド > ファイル`  | `コマンド` の出力を `ファイル` へ上書き出力
`コマンド >> ファイル` | `コマンド` の出力を `ファイル` へ追記出力
`コマンド < ファイル`  | `コマンド` の入力を `ファイル` から入力

みどり（通常）：
  入力リダイレクトの使い方…
  `passwd` で使えそう？
しげる（通常）：
  残念ながら `passwd` は
  パスワード設定を横着できないよう
  入力リダイレクトを拒否するんだ
しげる（笑顔）：
  でも良い着眼点だね
  そんな感じでリダイレクトを
  使える場面を探して
  Linux を便利に使っていこう！

