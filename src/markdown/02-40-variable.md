chapter=2
story=40
title=シェル変数
keyword=shell variable
prev=2/39/
prev-title=プロセス優先度
next=2/41/
next-title=コマンド置換

# シェル変数

しげる（通常）：
  今回は
  「シェル変数(shell variable)」を学ぼう
  データの「入れ物」みたいなものなんだ
  以降、単に「変数(variable)」と呼ぶよ
みどり（通常）：
  データの入れ物？
  どうやって
  使うのかな？

## シェル変数の定義

しげる（通常）：
  まずは変数の定義からだよ
  以下のようにして定義するんだ

```bash
変数名=値
```

しげる（通常）：
  ただし `=` の両脇には
  スペースを入れないでね
みどり（笑顔）：
  定義は簡単だね
  迷うことはなさそう！
しげる（通常）：
  では実際に試してみよう
しげる（通常）：
  `TIMER` という変数に
  タイマーの秒数を
  保持させよう
しげる（通常）：
  30秒タイマーにしたければ
  以下のようにするよ

```bash
TIMER=30
```

みどり（通常）：
  わかった！
みどり（通常）：
  …打ち込んだけど
  特に何も起こらないね
しげる（通常）：
  変数を設定しても
  何も表示されないんだ
  だけどシェルは変数の値を
  覚えてくれているよ

## シェル変数の参照

しげる（通常）：
  今度は変数の値を
  呼び出してみよう
  以下のように記述するよ

```bash
$変数名
```

みどり（通常）：
  これで変数の値を
  取り出せるのね！
しげる（通常）：
  それを確かめるために
  以下のコマンドを
  打ち込んでみよう

```bash
sleep $TIMER; tput bel
```

みどり（通常）：
  「セミコロン(`;`)」は…
  1行で複数のコマンドを
  書く書き方だったよね
しげる（通常）：
  そして `tput bel` は
  「ベルを鳴らす」だね
みどり（通常）：
  `TIMER` 変数に入っていた `30` が使われて
  `sleep 30` を実行してくれるんだね
みどり（笑顔）：
  30秒待った後にベルが鳴る…
  簡単な30秒タイマーとして
  機能するね！
しげる（通常）：
  じゃあ今度は
  `TIMER` 変数の
  値を変えてみよう
しげる（笑顔）：
  3分タイマーにしたければ
  以下のようにしてみてね

```bash
TIMER=180
```

みどり（通常）：
  3分は180秒だね！
  設定したよ！
しげる（通常）：
  そうしたら
  同じコマンドを
  再び実行してみよう

```bash
sleep $TIMER; tput bel
```

-- 3分後 --

みどり（驚き）：
  本当だ！
  3分待機してから
  ベルが鳴った！
みどり（通常）：
  実行するコマンドは同じなのに
  `TIMER` 変数の値を変えるだけで
  動きが変わるんだね
しげる（通常）：
  変数を使うと「変化する値」を
  簡単に操作できるようになるんだ

## 予め用意されている変数

しげる（通常）：
  シェルには
  初めから用意されている
  変数もあるんだ
  いくつか重要なものを紹介するね

変数名  | 変数の値
------- | --------
`PATH`  | コマンドを探すディレクトリのパス。複数のパスをコロン区切りで指定している
`HOME`  | ユーザのホームディレクトリのパス
`PWD`   | ワーキングディレクトリのパス
`USER`  | 現在ログインしているユーザ名
`SHELL` | 現在使っているシェルの実行ファイルのパス
`IFS`   | シェルが区切り文字として使う文字

みどり（通常）：
  こういう変数は
  勝手に定義されるんだね！

## 変数名に使える文字

しげる（通常）：
  自分で宣言する変数の
  変数名に使える文字には制限があるよ
  英大文字小文字数字と
  アンダースコア(`_`)が使えるんだ
  ただし1文字目には英数字は使えないよ
みどり（通常）：
  制限はあるけど
  自由な名前をつけるには
  十分そうだね
しげる（通常）：
  これは変数の値を
  文字の中に埋め込みたい場合に
  困る場合があるんだ
みどり（通常）：
  へぇ…
  どういう場合かな？
しげる（通常）：
  例えば `ユーザ名_id_rsa` というファイル名を
  扱いたい場合はどうすればいいと思う？
みどり（通常）：
  こうすれば
  いいんじゃ
  ないのかな？

```bash
$USER_id_rsa
```

しげる（通常）：
  実はこの指定だと
  意図どおりに動かないんだ
しげる（通常）：
  `$` 以降が全て変数で使える文字なので
  これは `USER_id_rsa` 変数だと判断されるよ
みどり（驚き）：
  なるほど…
  それは困っちゃうね
しげる（通常）：
  それを避けるために
  以下のような記述でも
  変数を呼び出せるんだ

```bash
${変数名}
```

しげる（通常）：
  さっきの例だと
  以下のようにすれば
  意図どおりに動くよ

```bash
${USER}_id_rsa
```

みどり（通常）：
  普段はそのままでいいけど
  変数名の区切りで
  困ることがあれば
  `${変数名}` と
  すればいいのね！

## まとめ

みどり（通常）：
  今回は「シェル変数」と
  その使い方について学んだよ！
しげる（通常）：
  シェル変数を使うことで
  コマンドを柔軟にしたり
  抽象的に扱えたりするんだ
  高度な操作に必要な機能なので
  使えるようにしておこう！

