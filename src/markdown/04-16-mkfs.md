chapter=4
story=16
title=ファイルシステム
keyword=super user
keyword=root
keyword=filesystem
keyword=mkfs
prev=4/15/
prev-title=fdiskコマンド
next=4/17/
next-title=ユーザ設定ファイル

# ファイルシステム

みどり（通常）：
  前回はパーティションを作成したよ！
  これでパーティションに
  ファイルを保存できるんだね
しげる（通常）：
  実はもう一段階作業が必要なんだよ
  今回は「ファイルシステム(file system)」を学ぼう

## 概要

みどり（通常）：
  パーティションを作った後は
  どんなことをしないと
  いけないのかな？
しげる（通常）：
  パーティション作成直後は
  更地のようなものなんだ
  ここにファイルを配置する
  ルールを決めないといけないよ
  そのようなルールを
  「ファイルシステム」と呼ぶんだ
みどり（通常）：
  へぇ…
  ファイルシステムには
  どんなのがあるのかな？
しげる（通常）：
  よく使われるものに
  以下があるんだ

ファイルシステム | 説明
---------------- | ----
`ext4`           | Linux の標準的なファイルシステム
`xfs`            | Linux で使われるファイルシステム。CPU やメモリのリソース使用量が多い代わりに高性能
`ntfs`           | 現在の Windows の標準的なファイルシステム(Windows XP 以降)
`vfat`           | 昔の Windows の標準的なファイルシステム。USB メモリや SD カードでも使われる
`iso9660`        | CD や DVD の標準的なファイルシステム

## `mkfs` コマンド

しげる（通常）：
  `mkfs` は
  ファイルシステムを作成するよ

```bash
mkfs [オプション]... [-t ファイルシステム] [ファイルシステム固有オプション]... デバイス [サイズ]
```

しげる（通常）：
  `mkfs` まで入力してから
  「TABキー」を2回押して
  補完を呼び出してみよう

```bash
mkfs!cursor!
```

みどり（通常）：
  うん！
  どうなるんだろうね？

```console
mkfs         mkfs.ext2    mkfs.ext4    mkfs.minix   mkfs.ntfs    mkfs.xfs
mkfs.cramfs  mkfs.ext3    mkfs.fat     mkfs.msdos   mkfs.vfat
```

みどり（通常）：
  `mkfs.` で始まる
  コマンドがたくさんあるね！
  「ドット(`.`)」の後は
  ファイルシステムかな？
しげる（通常）：
  そのとおり！
  `mkfs` は受付窓口のようなもので
  実際にファイルシステムを作るコマンドは
  `mkfs.ファイルシステム` なんだ
  `mkfs -t ファイルシステム` を実行すると
  `mkfs.ファイルシステム` が呼び出されるよ

## 実践

みどり（通常）：
  前回は USB メモリに
  パーティションを作成したよね！
  `lsblk` の出力は以下の通りだよ

```console
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda      8:0    0 953.9G  0 disk
├─sda1   8:1    0   512M  0 part /boot
└─sda2   8:2    0 953.4G  0 part /
sdb      8:16   0  28.9G  0 disk
└─sdb1   8:17   0  28.9G  0 part
```

しげる（通常）：
  `sdb` が USB メモリで
  `sdb1` が作成したパーティションだったね
  このパーティションを
  以下のようにしてフォーマットしよう！

```bash
sudo mkfs -t vfat -F 32 /dev/sdb1
```

しげる（通常）：
  `-F 32` は
  `FAT32` という形式で
  フォーマットする指定だよ
みどり（通常）：
  実行したよ！
しげる（通常）：
  では USB メモリを抜いて
  Windows や macOS に挿してみよう
  ちゃんと認識されるはずだよ
みどり（通常）：
  USB 取り外し時の操作は
  しなくてもいいのかな？
しげる（通常）：
  マウントしている場合は
  アンマウントの必要があるよ
  そうでなければ
  USB へアクセスする操作をしていなければ
  いつ取り外しても大丈夫だよ
みどり（通常）：
  そうなんだ！
  じゃあ取り外して
  他のマシンに差して
  確認してみるね！

----

みどり（笑顔）：
  ちゃんと認識されたよー！

## まとめ

みどり（通常）：
  今回はファイルシステムを学んだよ！
  `mkfs` でパーティションに
  ファイルシステムを作るんだ！
しげる（通常）：
  新しいストレージを
  追加する際などに
  必要となる操作だよ
  めったに行わないけど
  覚えておこう！

