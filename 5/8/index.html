<html lang="ja">
<head>
<title>Lから始まるLinux - 5章8話 SSH鍵生成(macOS,Linux)</title>
<base href="../..">
<meta charset="utf-8">
<meta name="author" content="Hironobu Nagaya">
<meta name="robots" content="all">
<meta name="keywords" content="Lから始まるLinux,Linux starts with L,linux,SSH,macOS,ssh-keygen">
<meta name="description" content="兄妹の対話を通してLinuxへの理解を深めていくお話です">
<meta name="viewport" content="width=device-width, initial-scale=0.5" />
<meta name="format-detection" content="telephone=no, email=no, address=no" />
<link rel="prev" href="5/7/" />
<link rel="next" href="5/9/" />
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link rel="stylesheet" href="css/normalize.css" type="text/css">
<link rel="stylesheet" href="css/common.css" type="text/css">
<link rel="stylesheet" href="css/story.css" type="text/css">
</head>
<body>
<header>
<h1>Lから始まるLinux</h1>
<div class="relation">
<div>
<div>前</div>
<div>5章7話</div>
<div><a href="5/7/">SSH鍵生成(Windows)</a></div>
</div>
<div>
<div>今</div>
<div>5章8話 SSH鍵生成(macOS,Linux)</div>
<div><a href=".">もくじ</a></div>
</div>
<div>
<div>次</div>
<div>5章9話</div>
<div><a href="5/9/">SSH接続先設定</a></div>
</div>
</div>
</header>
<main>
<section>
<article class="header1"><span>SSH鍵生成(macOS,Linux)</span></article>
<article class="talk">
<div><img src="img/midori.svg" alt="若木 みどり" /></div>
<div>
<span><span>お兄ちゃん！</span></span>
<span><span>macOS のノート PC があるんだけど</span></span>
<span><span>ここからでも</span></span>
<span><span>SSH 公開鍵認証で</span></span>
<span><span>接続できるかな？</span></span>
</div>
</article>
<article class="talk">
<div><img src="img/shigeru.svg" alt="若木 しげる" /></div>
<div>
<span><span>もちろん！</span></span>
<span><span>まずは必要となる二つの鍵</span></span>
<span><span><wbr>「秘密鍵」<wbr><wbr>「公開鍵」<wbr>を作ろう！</span></span>
<span><span>macOS と Linux では</span></span>
<span><span>操作がほとんど同じなので</span></span>
<span><span>一緒に説明するね</span></span>
</div>
</article>
<article class="header2"><code>.ssh</code><span> ディレクトリ</span></article>
<article class="talk">
<div><img src="img/shigeru.svg" alt="若木 しげる" /></div>
<div>
<span><span>SSH 設定は</span></span>
<span><code>~/.ssh</code><span> ディレクトリに保存されるよ</span></span>
<span><span>まずはこのディレクトリが</span></span>
<span><span>あるかどうかを確認しよう</span></span>
</div>
</article>
<article class="code"><pre><code class="bash">ls <wbr>-ld <wbr>~/.ssh
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>うん！</span></span></div></article><article class="code"><pre><code class="bash">drwx------. <wbr>2 <wbr>midori <wbr>midori <wbr>71 <wbr>Dec  <wbr>1 <wbr>14:53 <wbr>/home/midori/.ssh
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>ちゃんとあるみたいだね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>もし存在していなければ</span></span><span><span>作ってあげよう</span></span></div></article><article class="code"><pre><code class="bash">mkdir <wbr>~/.ssh
</code></pre></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>そうしたらパーミッションを確認しよう</span></span><span><span>自身しかアクセスできないように</span></span><span><span>なっていればいいよ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><code>rwx------</code><span> だね！</span></span><span><span>所有グループや</span></span><span><span>他のユーザには</span></span><span><span>何も権限が無いよ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>もしそうでないなら </span><code>chmod</code><span> で</span></span><span><span>パーミッションを設定しよう！</span></span></div></article><article class="code"><pre><code class="bash">chmod <wbr>700 <wbr>~/.ssh
</code></pre></article><article class="header2"><code>ssh-keygen</code><span> コマンド</span></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><code>ssh-keygen</code><span> は</span></span><span><span>SSH 鍵を生成するよ</span></span></div></article><article class="code"><pre><code class="bash">ssh-keygen <wbr>[オプション]...
</code></pre></article><article class="table"><table><thead><tr><th><span>オプション</span></th><th><span>役割</span></th></tr></thead><tbody><tr><td><code>-f パス</code></td><td><span>鍵の出力先を指定(RSAの場合デフォルトは </span><code>~/.ssh/id_rsa</code><span>)</span></td></tr><tr><td><code>-C コメント</code></td><td><span>鍵にコメントを設定</span></td></tr><tr><td><code>-P パスフレーズ</code></td><td><span>パスフレーズを設定(空文字でパスフレーズを設定しない)</span></td></tr></tbody></table></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>コメントは</span></span><span><span>何に使うのかな？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>複数の鍵を生成したときに</span></span><span><span>鍵の区別をつけるために使われるよ</span></span><span><span><wbr>「ユーザ名」<wbr><wbr>「接続先」<wbr>の</span></span><span><span>2つの情報を含めておくのがいいね</span></span><span><span>僕は </span><code>ユーザ名@接続先</code><span> としているよ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>パスフレーズを設定すると</span></span><span><span>どうなるのかな？</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>鍵を使おうとするたびに</span></span><span><span>パスフレーズの入力が求められるよ</span></span><span><span>そこで正しいパスフレーズを</span></span><span><span>入力しないと鍵が使えないんだ</span></span><span><span>設定すると毎回入力の手間が掛かるけど</span></span><span><span>鍵が漏洩したときの対策になるんだ</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>なるほど</span></span><span><span>自宅内で使う想定で</span></span><span><span>毎回尋ねられるのも面倒だから</span></span><span><span>今回は設定しなくても</span></span><span><span>いいと思っているよ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>ここでは以下のように作成しよう！</span></span><span><code>接続先ホスト名</code><span> の箇所は</span></span><span><span>実際の値に置き換えてね</span></span></div></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>私の場合は </span><code>DEST=carter</code><span> となるんだね！</span></span></div></article><article class="code"><pre><code class="bash">DEST=接続先ホスト名
ssh-keygen <wbr>-f <wbr>&quot;$HOME/.ssh/$USER@${DEST}_id_rsa&quot; <wbr>-C <wbr>&quot;$USER@$DEST&quot; <wbr>-P <wbr>&quot;&quot;
</code></pre></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>変数を上手く</span></span><span><span>使っているんだね！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>上記のコマンドを実行すると</span></span><span><span><wbr>「秘密鍵」<wbr>と<wbr>「公開鍵」<wbr>が</span></span><span><span>生成されるんだ</span></span></div></article><article class="table"><table><thead><tr><th><span>パス</span></th><th><span>役割</span></th></tr></thead><tbody><tr><td><code>~/.ssh/ユーザ名@接続先_id_rsa</code></td><td><span>秘密鍵</span></td></tr><tr><td><code>~/.ssh/ユーザ名@接続先_id_rsa.pub</code></td><td><span>公開鍵</span></td></tr></tbody></table></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>これで準備が</span></span><span><span>できたんだね！</span></span></div></article><article class="header2"><span>まとめ</span></article><article class="talk"><div><img src="img/midori.svg" alt="若木 みどり" /></div><div><span><span>今回は macOS や Linux で</span></span><span><span>SSH 鍵を生成したよ！</span></span><span><span>公開鍵認証でリモート接続するための</span></span><span><span>第一歩なんだ！</span></span></div></article><article class="talk"><div><img src="img/shigeru.svg" alt="若木 しげる" /></div><div><span><span>この鍵を使うには</span></span><span><span>接続先にも設定が必要なんだ</span></span><span><span>次回は接続先で行う設定を説明するよ！</span></span></div></article></section></main><footer><div class="relation"><div><div>前</div><div>5章7話</div><div><a href="5/7/">SSH鍵生成(Windows)</a></div></div><div><div>今</div><div>5章8話 SSH鍵生成(macOS,Linux)</div><div><a href=".">もくじ</a></div></div><div><div>次</div><div>5章9話</div><div><a href="5/9/">SSH接続先設定</a></div></div></div></footer><script src="js/jquery.js"></script><script src="js/common.js"></script></body></html>
